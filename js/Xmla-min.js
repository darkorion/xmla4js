(function(){var B="http://schemas.xmlsoap.org/soap/",d=B+"envelope/",f="SOAP-ENV",j="xmlns:"+f+'="'+d+'"',t=f+':encodingStyle="'+B+'encoding/"',h="urn:schemas-microsoft-com:",u=h+"xml-analysis",g='xmlns="'+u+'"',E="sql",i=h+"xml-sql",c="xsd",C="http://www.w3.org/2001/XMLSchema",b=u+":rowset",a=window.ActiveXObject?true:false;function e(G){var I;if(a){I=new ActiveXObject("MSXML2.XMLHTTP.3.0")}else{I=new XMLHttpRequest()}I.open("POST",G.url,G.async);var F=false;var H=function(){F=true;switch(I.readyState){case 0:G.aborted(I);break;case 4:if(I.status===200){G.complete(I,"success")}else{G.error(I,I.status,null)}break}};I.onreadystatechange=H;I.setRequestHeader("Content-Type","text/xml");I.send(G.data);if(!G.async&&!F){H.call(I)}return I}function r(F){return typeof(F)==="undefined"}function D(F){return typeof(F)==="function"}function x(F){return typeof(F)==="string"}function z(F){return typeof(F)==="number"}function v(F){return typeof(F)==="object"}function o(F){return F.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var m=function(H,G,I,F){if(D(H.getElementsByTagNameNS)){return H.getElementsByTagNameNS(G,F)}else{if(I){return H.getElementsByTagName(I+":"+F)}else{return H.getElementsByTagName(F)}}};var n=function(G,H,I,F){if(D(G.getAttributeNS)){return G.getAttributeNS(H,F)}else{if(I){return G.getAttribute(I+":"+F)}else{return G.getAttribute(F)}}};function s(F,K,I){var G="<"+F+">";if(I){var N;G+="<"+K+">";for(var M in I){if(I.hasOwnProperty(M)){N=I[M];G+="<"+M+">";if(typeof(N)==="array"){for(var L,H=0,J=N.length;H<J;H++){L=N[H];G+="<Value>"+o(L)+"</Value>"}}else{G+=o(N)}G+="</"+M+">"}}G+="</"+K+">"}G+="</"+F+">";return G}function A(F){var H="";var I=F.method;H+="<"+f+":Envelope "+j+" "+t+"><"+f+":Body><"+I+" "+g+" "+t+">";var G=null;switch(I){case Xmla.METHOD_DISCOVER:if(r(F.requestType)){G={name:"Missing request type",description:'Requests of the "Discover" method must specify a requestType.'}}else{H+="<"+l+">"+F.requestType+"</"+l+">"+s("Restrictions","RestrictionList",F.restrictions)+s("Properties","PropertyList",F.properties)}break;case Xmla.METHOD_EXECUTE:if(r(F.statement)){G={name:"Missing statement",description:'Requests of the "Execute" method must specify an MDX statement.'}}else{H+="<Command><Statement>"+F.statement+"</Statement></Command>"+s("Properties","PropertyList",F.properties)}break;default:G={name:"Invalid XMLA method",description:'The method must be either "Discover" or "Execute".'}}if(G!==null){throw G}H+="   </"+I+"></"+f+":Body></"+f+":Envelope>";return H}function w(G,H,F){if(H&&(!G)){G={}}for(var I in H){if(H.hasOwnProperty(I)){if(F||r(G[I])){G[I]=H[I]}}}return G}Xmla=function(F){this.listeners={};this.listeners[Xmla.EVENT_REQUEST]=[];this.listeners[Xmla.EVENT_SUCCESS]=[];this.listeners[Xmla.EVENT_ERROR]=[];this.listeners[Xmla.EVENT_DISCOVER]=[];this.listeners[Xmla.EVENT_DISCOVER_SUCCESS]=[];this.listeners[Xmla.EVENT_DISCOVER_ERROR]=[];this.listeners[Xmla.EVENT_EXECUTE]=[];this.listeners[Xmla.EVENT_EXECUTE_SUCCESS]=[];this.listeners[Xmla.EVENT_EXECUTE_ERROR]=[];this.options=w(w({},Xmla.defaultOptions,true),F,true)};Xmla.defaultOptions={requestTimeout:30000,async:false};Xmla.METHOD_DISCOVER="Discover";Xmla.METHOD_EXECUTE="Execute";var l="RequestType";var p="DISCOVER_";var k="MDSCHEMA_";var q="DBSCHEMA_";Xmla.DISCOVER_DATASOURCES=p+"DATASOURCES";Xmla.DISCOVER_PROPERTIES=p+"PROPERTIES";Xmla.DISCOVER_SCHEMA_ROWSETS=p+"SCHEMA_ROWSETS";Xmla.DISCOVER_ENUMERATORS=p+"ENUMERATORS";Xmla.DISCOVER_KEYWORDS=p+"KEYWORDS";Xmla.DISCOVER_LITERALS=p+"LITERALS";Xmla.DBSCHEMA_CATALOGS=q+"CATALOGS";Xmla.DBSCHEMA_COLUMNS=q+"COLUMNS";Xmla.DBSCHEMA_PROVIDER_TYPES=q+"PROVIDER_TYPES";Xmla.DBSCHEMA_SCHEMATA=q+"SCHEMATA";Xmla.DBSCHEMA_TABLES=q+"TABLES";Xmla.DBSCHEMA_TABLES_INFO=q+"TABLES_INFO";Xmla.MDSCHEMA_ACTIONS=k+"ACTIONS";Xmla.MDSCHEMA_CUBES=k+"CUBES";Xmla.MDSCHEMA_DIMENSIONS=k+"DIMENSIONS";Xmla.MDSCHEMA_FUNCTIONS=k+"FUNCTIONS";Xmla.MDSCHEMA_HIERARCHIES=k+"HIERARCHIES";Xmla.MDSCHEMA_LEVELS=k+"LEVELS";Xmla.MDSCHEMA_MEASURES=k+"MEASURES";Xmla.MDSCHEMA_MEMBERS=k+"MEMBERS";Xmla.MDSCHEMA_PROPERTIES=k+"PROPERTIES";Xmla.MDSCHEMA_SETS=k+"SETS";Xmla.EVENT_REQUEST="request";Xmla.EVENT_SUCCESS="success";Xmla.EVENT_ERROR="error";Xmla.EVENT_EXECUTE="execute";Xmla.EVENT_EXECUTE_SUCCESS="executesuccess";Xmla.EVENT_EXECUTE_ERROR="executeerror";Xmla.EVENT_DISCOVER="discover";Xmla.EVENT_DISCOVER_SUCCESS="discoversuccess";Xmla.EVENT_DISCOVER_ERROR="discovererror";Xmla.EVENT_GENERAL=[Xmla.EVENT_REQUEST,Xmla.EVENT_SUCCESS,Xmla.EVENT_ERROR];Xmla.EVENT_DISCOVER_ALL=[Xmla.EVENT_DISCOVER,Xmla.EVENT_DISCOVER_SUCCESS,Xmla.EVENT_DISCOVER_ERROR];Xmla.EVENT_EXECUTE_ALL=[Xmla.EVENT_EXECUTE,Xmla.EVENT_EXECUTE_SUCCESS,Xmla.EVENT_EXECUTE_ERROR];Xmla.EVENT_ALL=[].concat(Xmla.EVENT_GENERAL,Xmla.EVENT_DISCOVER_ALL,Xmla.EVENT_EXECUTE_ALL);Xmla.PROP_DATASOURCEINFO="DataSourceInfo";Xmla.PROP_CATALOG="Catalog";Xmla.PROP_CUBE="Cube";Xmla.PROP_FORMAT="Format";Xmla.PROP_FORMAT_TABULAR="Tabular";Xmla.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";Xmla.PROP_AXISFORMAT="AxisFormat";Xmla.PROP_AXISFORMAT_TUPLE="TupleFormat";Xmla.PROP_AXISFORMAT_CLUSTER="ClusterFormat";Xmla.PROP_AXISFORMAT_CUSTOM="CustomFormat";Xmla.PROP_CONTENT="Content";Xmla.PROP_CONTENT_DATA="Data";Xmla.PROP_CONTENT_NONE="None";Xmla.PROP_CONTENT_SCHEMA="Schema";Xmla.PROP_CONTENT_SCHEMADATA="SchemaData";Xmla.prototype={listeners:null,response:null,responseText:null,responseXml:null,setOptions:function(F){w(this.options,F,true)},addListener:function(K){var I=K.events;if(r(I)){throw"No events specified"}if(x(I)){if(I==="all"){I=Xmla.EVENT_ALL}else{I=I.split(",")}}if(!(I instanceof Array)){throw'Property "events" must be comma separated list string or array.'}var H=I.length;var F,J;for(var G=0;G<H;G++){F=I[G].replace(/\s+/g,"");J=this.listeners[F];if(!J){throw'Event "'+F+'" is not defined.'}if(D(K.handler)){if(!v(K.scope)){K.scope=window}J.push(K)}else{throw"Invalid listener: handler is not a function"}}},_fireEvent:function(K,N,G){var L=this.listeners[K];if(!L){throw'Event "'+K+'" is not defined.'}var J=L.length;var F=true;if(J){var H,M;for(var I=0;I<J;I++){H=L[I];M=H.handler.call(H.scope,K,N,this);if(G&&M===false){F=false;break}}}else{if(K==="error"){throw N}}return F},request:function(G){var H=this;var I=A(G);G.soapMessage=I;var J;var F={async:r(G.async)?this.options.async:G.async,timeout:this.options.requestTimeout,contentType:"text/xml",data:I,dataType:"xml",error:function(M,L,K){H._requestError({xmla:H,request:G,xhr:M,error:{errorCategory:"xhrError",errorString:L,errorObject:K}})},complete:function(K,L){if(L==="success"){H._requestSuccess({xmla:H,request:G,xhr:K,status:status})}},url:r(G.url)?this.options.url:G.url,type:"POST"};if(G.username){F.username=G.username}if(G.password){F.password=G.password}if(this.response){this.response.close()}this.response=null;this.responseText=null;this.responseXml=null;if(this._fireEvent(Xmla.EVENT_REQUEST,G,true)&&((G.method==Xmla.METHOD_DISCOVER&&this._fireEvent(Xmla.EVENT_DISCOVER,G))||(G.method==Xmla.METHOD_EXECUTE&&this._fireEvent(Xmla.EVENT_EXECUTE,G)))){J=e(F)}return this.response},_requestError:function(F){F.xmla=this;this._fireEvent("error",F)},_requestSuccess:function(L){var P=L.xhr;this.responseXML=P.responseXML;this.responseText=P.responseText;var K=L.request;var F=K.method;var H=m(this.responseXML,d,f,"Fault");if(H.length){H=H.item(0);var M=H.getElementsByTagName("faultcode").item(0).childNodes.item(0).data;var I=H.getElementsByTagName("faultstring").item(0).childNodes.item(0).data;var J={errorCategory:"soapFault",faultCode:M,faultString:I};L.error=J;switch(F){case Xmla.METHOD_DISCOVER:this._fireEvent(Xmla.EVENT_DISCOVER_ERROR,L);break;case Xmla.METHOD_EXECUTE:this._fireEvent(Xmla.EVENT_EXECUTE_ERROR,L);break}this._fireEvent(Xmla.EVENT_ERROR,L)}else{switch(F){case Xmla.METHOD_DISCOVER:var G=new Xmla.Rowset(this.responseXML,K.requestType);L.rowset=G;this.response=G;this._fireEvent(Xmla.EVENT_DISCOVER_SUCCESS,L);break;case Xmla.METHOD_EXECUTE:var N;var O=K.properties[Xmla.PROP_FORMAT];switch(O){case Xmla.PROP_FORMAT_TABULAR:break;case Xmla.PROP_FORMAT_MULTIDIMENSIONAL:break}L.resultset=N;this.response=N;this._fireEvent(Xmla.EVENT_EXECUTE_SUCCESS,L);break}this._fireEvent(Xmla.EVENT_SUCCESS,L)}},execute:function(F){var I,G=F.properties;if(r(G)){G={};F.properties=G}if(r(G[Xmla.PROP_CONTENT])){G[Xmla.PROP_CONTENT]=Xmla.PROP_CONTENT_SCHEMADATA}if(r(G[Xmla.PROP_FORMAT])){F.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL}var H=w(F,{method:Xmla.METHOD_EXECUTE},true);return this.request(H)},discover:function(F){var G=w(F,{method:Xmla.METHOD_DISCOVER},true);return this.request(G)},discoverDataSources:function(F){var G=w(F,{requestType:Xmla.DISCOVER_DATASOURCES},true);return this.discover(G)},discoverProperties:function(F){var G=w(F,{requestType:Xmla.DISCOVER_PROPERTIES},true);return this.discover(G)},discoverSchemaRowsets:function(F){var G=w(F,{requestType:Xmla.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(G)},discoverEnumerators:function(F){var G=w(F,{requestType:Xmla.DISCOVER_ENUMERATORS},true);return this.discover(G)},discoverKeywords:function(F){var G=w(F,{requestType:Xmla.DISCOVER_KEYWORDS},true);return this.discover(G)},discoverLiterals:function(F){var G=w(F,{requestType:Xmla.DISCOVER_LITERALS},true);return this.discover(G)},discoverDBCatalogs:function(F){var G=w(F,{requestType:Xmla.DBSCHEMA_CATALOGS},true);return this.discover(G)},discoverDBColumns:function(F){var G=w(F,{requestType:Xmla.DBSCHEMA_COLUMNS},true);return this.discover(G)},discoverDBProviderTypes:function(F){var G=w(F,{requestType:Xmla.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(G)},discoverDBSchemata:function(F){var G=w(F,{requestType:Xmla.DBSCHEMA_SCHEMATA},true);return this.discover(G)},discoverDBTables:function(F){var G=w(F,{requestType:Xmla.DBSCHEMA_TABLES},true);return this.discover(G)},discoverDBTablesInfo:function(F){var G=w(F,{requestType:Xmla.DBSCHEMA_TABLES_INFO},true);return this.discover(G)},discoverMDActions:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_ACTIONS},true);return this.discover(G)},discoverMDCubes:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_CUBES},true);return this.discover(G)},discoverMDDimensions:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_DIMENSIONS},true);return this.discover(G)},discoverMDFunctions:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_FUNCTIONS},true);return this.discover(G)},discoverMDHierarchies:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_HIERARCHIES},true);return this.discover(G)},discoverMDLevels:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_LEVELS},true);return this.discover(G)},discoverMDMeasures:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_MEASURES},true);return this.discover(G)},discoverMDMembers:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_MEMBERS},true);return this.discover(G)},discoverMDProperties:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_PROPERTIES},true);return this.discover(G)},discoverMDSets:function(F){var G=w(F,{requestType:Xmla.MDSCHEMA_SETS},true);return this.discover(G)}};function y(J){var G=m(J,C,c,"complexType"),I=G.length,H,F;for(F=0;F<I;F++){H=G.item(F);if(H.getAttribute("name")==="row"){return H}}return null}Xmla.Rowset=function(G,M){this.rows=m(G,b,null,"row");this.numRows=this.rows?this.rows.length:0;this.rowIndex=0;this.row=(this.hasMoreRows())?this.rows.item(this.rowIndex):null;this.fieldOrder=[];this.fields={};this._fieldCount=0;var L=y(G);if(L){var R=m(L,C,c,"sequence").item(0),I=R.childNodes,K=I.length,P,F,Q,N,H,O;for(var J=0;J<K;J++){P=I.item(J);if(P.nodeType!=1){continue}F=n(P,i,E,"field");Q=P.getAttribute("name");O=P.getAttribute("type");if(!O&&M==Xmla.DISCOVER_SCHEMA_ROWSETS&&Q=="Restrictions"){O="Restrictions"}N=P.getAttribute("minOccurs");H=P.getAttribute("maxOccurs");this.fields[F]={name:Q,label:F,index:this._fieldCount++,type:O,minOccurs:r(N)?1:N,maxOccurs:r(H)?1:(H==="unbounded"?Infinity:H),getter:this._createFieldGetter(Q,O,N,H)};this.fieldOrder.push(F)}}else{throw"Couldn't parse XML schema while constructing resultset"}};Xmla.Rowset.prototype={_boolConverter:function(F){return F==="true"?true:false},_intConverter:function(F){return parseInt(F,10)},_floatConverter:function(F){return parseFloat(F,10)},_textConverter:function(F){return F},_restrictionsConverter:function(F){return F},_arrayConverter:function(H,G){var F=[],J=H.length,K;for(var I=0;I<J;I++){K=H.item(I);F.push(G(this._elementText(K)))}return F},_elementText:function(G){if(G.innerText){return G.innerText}else{if(G.textContent){return G.textContent}else{var J="",I=G.childNodes,H=I.length;for(var F=0;F<H;F++){J+=I.item(F).data}return J}}},_createFieldGetter:function(L,I,K,H){if(K===null){K="1"}if(H===null){H="1"}var J=this;var G=null;switch(I){case"xsd:boolean":G=J._boolConverter;break;case"xsd:decimal":case"xsd:double":case"xsd:float":G=J._floatConverter;break;case"xsd:int":case"xsd:integer":case"xsd:nonPositiveInteger":case"xsd:negativeInteger":case"xsd:nonNegativeInteger":case"xsd:positiveInteger":case"xsd:short":case"xsd:byte":case"xsd:long":case"xsd:unsignedLong":case"xsd:unsignedInt":case"xsd:unsignedShort":case"xsd:unsignedByte":G=J._intConverter;break;case"xsd:string":G=J._textConverter;break;case"Restrictions":G=J._restrictionsConverter;break;default:G=J._textConverter;break}var F;if(H==="1"){if(K==="1"){F=function(){var M=m(this.row,b,null,L);return G(J._elementText(M.item(0)))}}else{if(K==="0"){F=function(){var M=m(this.row,b,null,L);if(!M.length){return null}else{return G(J._elementText(M.item(0)))}}}}}else{if(K==="1"){F=function(){var M=m(this.row,b,null,L);return J._arrayConverter(M,G)}}else{if(K==="0"){F=function(){var M=m(this.row,b,null,L);if(!M.length){return null}else{return J._arrayConverter(M,G)}}}}}return F},getFields:function(){var I=[],H=this._fieldCount,F=this.fieldOrder;for(var G=0;G<H;G++){I[G]=this.fieldDef(F[G])}return I},hasMoreRows:function(){return this.numRows>this.rowIndex},next:function(){this.row=this.rows.item(++this.rowIndex)},fieldDef:function(F){var G=this.fields[F];if(r(G)){throw'No such field: "'+F+'"'}return G},fieldIndex:function(F){var G=this.fieldDef(F);return G.index},fieldName:function(F){return this.fieldOrder[F]},fieldVal:function(F){if(z(F)){F=this.fieldName(F)}var G=this.fieldDef(F);return G.getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this.row=null;this.rows=null},fetchAsArray:function(){var I,F,H,G;if(this.hasMoreRows()){F=this.fields;I=[];for(H in F){if(F.hasOwnProperty(H)){G=F[H];I[G.index]=G.getter.call(this)}}this.next()}else{I=false}return I},fetchAsObject:function(){var G,F,I,H;if(this.hasMoreRows()){F=this.fields;G={};for(I in F){if(F.hasOwnProperty(I)){H=F[I];G[I]=H.getter.call(this)}}this.next()}else{G=false}return G},fetchAllAsArray:function(){var G,F=[];while((G=this.fetchAsArray())){F.push(G)}return F},fetchAllAsObject:function(){var G,F=[];while((G=this.fetchAsObject())){F.push(G)}return F}}}());