var Xmla;(function(){var z="http://schemas.xmlsoap.org/soap/",d=z+"envelope/",g="SOAP-ENV",l="xmlns:"+g+'="'+d+'"',u=g+':encodingStyle="'+z+'encoding/"',j="urn:schemas-microsoft-com:",w=j+"xml-analysis",i='xmlns="'+w+'"',E="sql",k=j+"xml-sql",B="http://www.w3.org/2001/XMLSchema",c="xsd",C="http://www.w3.org/2001/XMLSchema-instance",D="xsi",b=w+":rowset",v=w+":mddataset",a=window.ActiveXObject?true:false;function f(G){var I,F=false,H=function(){F=true;switch(I.readyState){case 0:G.aborted(I);break;case 4:if(I.status===200){G.complete(I)}else{G.error(Xmla.Exception._newError("HTTP_ERROR","_ajax",G))}break}};if(a){I=new ActiveXObject("MSXML2.XMLHTTP.3.0")}else{I=new XMLHttpRequest()}if(G.username&&G.password){I.open("POST",G.url,G.async,G.username,G.password)}else{I.open("POST",G.url,G.async)}I.onreadystatechange=H;I.setRequestHeader("Content-Type","text/xml");I.send(G.data);if(!G.async&&!F){H.call(I)}return I}function A(F){return typeof(F)==="undefined"}function q(F){return F.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var o=document.getElementsByTagNameNS?function(H,G,I,F){return H.getElementsByTagNameNS(G,F)}:function(H,G,I,F){if(I){return H.getElementsByTagName(I+":"+F)}else{return H.getElementsByTagName(F)}};var p=document.documentElement.getAttributeNS?function(G,H,I,F){return G.getAttributeNS(H,F)}:function(G,H,I,F){if(I){return G.getAttribute(I+":"+F)}else{return G.getAttribute(F)}};function t(F,L,J,H){if(!H){H=""}var K,I,M,N,O,G="\n"+H+"<"+F+">";if(J){G+="\n"+H+" <"+L+">";for(N in J){if(J.hasOwnProperty(N)){O=J[N];G+="\n"+H+"  <"+N+">";if(typeof(O)==="array"){for(M,I=0,K=O.length;I<K;I+=1){M=O[I];G+="<Value>"+q(M)+"</Value>"}}else{G+=q(O)}G+="</"+N+">"}}G+="\n"+H+" </"+L+">"}G+="\n"+H+"</"+F+">";return G}var n="RequestType";function y(F){var H="",I=F.method,G=null;H+="\n<"+g+":Envelope "+l+" "+u+">\n <"+g+":Body>\n  <"+I+" "+i+" "+u+">";switch(I){case Xmla.METHOD_DISCOVER:if(F.requestType){H+="\n   <"+n+">"+F.requestType+"</"+n+">"+t("Restrictions","RestrictionList",F.restrictions,"   ")+t("Properties","PropertyList",F.properties,"   ")}else{G=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",F)}break;case Xmla.METHOD_EXECUTE:if(F.statement){H+="\n   <Command>\n    <Statement>"+F.statement+"</Statement>\n   </Command>"+t("Properties","PropertyList",F.properties,"   ")}else{G=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",F)}break;default:}if(G!==null){G._throw()}H+="\n  </"+I+">\n </"+g+":Body>\n</"+g+":Envelope>";return H}function h(G,H,F){if(H&&(!G)){G={}}for(var I in H){if(H.hasOwnProperty(I)){if(F||A(G[I])){G[I]=H[I]}}}return G}Xmla=function(F){this.listeners={};this.listeners[Xmla.EVENT_REQUEST]=[];this.listeners[Xmla.EVENT_SUCCESS]=[];this.listeners[Xmla.EVENT_ERROR]=[];this.listeners[Xmla.EVENT_DISCOVER]=[];this.listeners[Xmla.EVENT_DISCOVER_SUCCESS]=[];this.listeners[Xmla.EVENT_DISCOVER_ERROR]=[];this.listeners[Xmla.EVENT_EXECUTE]=[];this.listeners[Xmla.EVENT_EXECUTE_SUCCESS]=[];this.listeners[Xmla.EVENT_EXECUTE_ERROR]=[];this.options=h(h({},Xmla.defaultOptions,true),F,true);return this};Xmla.defaultOptions={requestTimeout:30000,async:false};Xmla.METHOD_DISCOVER="Discover";Xmla.METHOD_EXECUTE="Execute";var r="DISCOVER_";var m="MDSCHEMA_";var s="DBSCHEMA_";Xmla.DISCOVER_DATASOURCES=r+"DATASOURCES";Xmla.DISCOVER_PROPERTIES=r+"PROPERTIES";Xmla.DISCOVER_SCHEMA_ROWSETS=r+"SCHEMA_ROWSETS";Xmla.DISCOVER_ENUMERATORS=r+"ENUMERATORS";Xmla.DISCOVER_KEYWORDS=r+"KEYWORDS";Xmla.DISCOVER_LITERALS=r+"LITERALS";Xmla.DBSCHEMA_CATALOGS=s+"CATALOGS";Xmla.DBSCHEMA_COLUMNS=s+"COLUMNS";Xmla.DBSCHEMA_PROVIDER_TYPES=s+"PROVIDER_TYPES";Xmla.DBSCHEMA_SCHEMATA=s+"SCHEMATA";Xmla.DBSCHEMA_TABLES=s+"TABLES";Xmla.DBSCHEMA_TABLES_INFO=s+"TABLES_INFO";Xmla.MDSCHEMA_ACTIONS=m+"ACTIONS";Xmla.MDSCHEMA_CUBES=m+"CUBES";Xmla.MDSCHEMA_DIMENSIONS=m+"DIMENSIONS";Xmla.MDSCHEMA_FUNCTIONS=m+"FUNCTIONS";Xmla.MDSCHEMA_HIERARCHIES=m+"HIERARCHIES";Xmla.MDSCHEMA_LEVELS=m+"LEVELS";Xmla.MDSCHEMA_MEASURES=m+"MEASURES";Xmla.MDSCHEMA_MEMBERS=m+"MEMBERS";Xmla.MDSCHEMA_PROPERTIES=m+"PROPERTIES";Xmla.MDSCHEMA_SETS=m+"SETS";Xmla.EVENT_REQUEST="request";Xmla.EVENT_SUCCESS="success";Xmla.EVENT_ERROR="error";Xmla.EVENT_EXECUTE="execute";Xmla.EVENT_EXECUTE_SUCCESS="executesuccess";Xmla.EVENT_EXECUTE_ERROR="executeerror";Xmla.EVENT_DISCOVER="discover";Xmla.EVENT_DISCOVER_SUCCESS="discoversuccess";Xmla.EVENT_DISCOVER_ERROR="discovererror";Xmla.EVENT_GENERAL=[Xmla.EVENT_REQUEST,Xmla.EVENT_SUCCESS,Xmla.EVENT_ERROR];Xmla.EVENT_DISCOVER_ALL=[Xmla.EVENT_DISCOVER,Xmla.EVENT_DISCOVER_SUCCESS,Xmla.EVENT_DISCOVER_ERROR];Xmla.EVENT_EXECUTE_ALL=[Xmla.EVENT_EXECUTE,Xmla.EVENT_EXECUTE_SUCCESS,Xmla.EVENT_EXECUTE_ERROR];Xmla.EVENT_ALL=[].concat(Xmla.EVENT_GENERAL,Xmla.EVENT_DISCOVER_ALL,Xmla.EVENT_EXECUTE_ALL);Xmla.PROP_DATASOURCEINFO="DataSourceInfo";Xmla.PROP_CATALOG="Catalog";Xmla.PROP_CUBE="Cube";Xmla.PROP_FORMAT="Format";Xmla.PROP_FORMAT_TABULAR="Tabular";Xmla.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";Xmla.PROP_AXISFORMAT="AxisFormat";Xmla.PROP_AXISFORMAT_TUPLE="TupleFormat";Xmla.PROP_AXISFORMAT_CLUSTER="ClusterFormat";Xmla.PROP_AXISFORMAT_CUSTOM="CustomFormat";Xmla.PROP_CONTENT="Content";Xmla.PROP_CONTENT_DATA="Data";Xmla.PROP_CONTENT_NONE="None";Xmla.PROP_CONTENT_SCHEMA="Schema";Xmla.PROP_CONTENT_SCHEMADATA="SchemaData";Xmla.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXML:null,setOptions:function(F){h(this.options,F,true)},addListener:function(K){var I=K.events;if(!I){Xmla.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",K)._throw()}if(typeof(I)==="string"){if(I==="all"){I=Xmla.EVENT_ALL}else{I=I.split(",")}}if(!(I instanceof Array)){Xmla.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",K)._throw()}var H=I.length;var F,J;for(var G=0;G<H;G+=1){F=I[G].replace(/\s+/g,"");J=this.listeners[F];if(!J){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",K)._throw()}if(typeof(K.handler)=="function"){if(!K.scope){K.scope=window}J.push(K)}else{Xmla.Exception._newError("INVALID_EVENT_HANDLER","Xmla.addListener",K)._throw()}}},_fireEvent:function(K,N,G){var L=this.listeners[K];if(!L){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",K)._throw()}var J=L.length;var F=true;if(J){var H,M;for(var I=0;I<J;I+=1){H=L[I];M=H.handler.call(H.scope,K,N,this);if(G&&M===false){F=false;break}}}else{if(K==="error"){N.exception._throw()}}return F},request:function(G){var I,H=this;this.response=null;this.responseText=null;this.responseXML=null;if(!G.url){if(this.options.url){G.url=this.options.url}else{I=Xmla.Exception._newError("MISSING_URL","Xmla.request",G);I._throw()}}G.properties=h(G.properties,this.options.properties,false);G.restrictions=h(G.restrictions,this.options.restrictions,false);if(A(G.async)&&!A(this.options.async)){G.async=this.options.async}if(A(G.requestTimeout)&&!A(this.options.requestTimeout)){G.requestTimeout=this.options.requestTimeout}if(!G.username&&this.options.username){G.username=this.options.username}if(!G.password&&this.options.password){G.password=this.options.password}var J=y(G);this.soapMessage=J;var K;var F={async:G.async,timeout:G.requestTimeout,data:J,error:function(L){G.exception=L;H._requestError(G)},complete:function(L){G.xhr=L;H._requestSuccess(G)},url:G.url};if(G.username){F.username=G.username}if(G.password){F.password=G.password}if(this._fireEvent(Xmla.EVENT_REQUEST,G,true)&&((G.method==Xmla.METHOD_DISCOVER&&this._fireEvent(Xmla.EVENT_DISCOVER,G))||(G.method==Xmla.METHOD_EXECUTE&&this._fireEvent(Xmla.EVENT_EXECUTE,G)))){K=f(F)}return this.response},_requestError:function(F){this._fireEvent("error",F)},_requestSuccess:function(G){var K=G.xhr;this.responseXML=K.responseXML;this.responseText=K.responseText;var L=G.method;var F=o(this.responseXML,d,g,"Fault");if(F.length){F=F.item(0);G.exception=new Xmla.Exception(Xmla.Exception.TYPE_ERROR,F.getElementsByTagName("faultcode").item(0).childNodes.item(0).data,F.getElementsByTagName("faultstring").item(0).childNodes.item(0).data,null,"_requestSuccess",G);switch(L){case Xmla.METHOD_DISCOVER:this._fireEvent(Xmla.EVENT_DISCOVER_ERROR,G);break;case Xmla.METHOD_EXECUTE:this._fireEvent(Xmla.EVENT_EXECUTE_ERROR,G);break}this._fireEvent(Xmla.EVENT_ERROR,G)}else{switch(L){case Xmla.METHOD_DISCOVER:var J=new Xmla.Rowset(this.responseXML,G.requestType);G.rowset=J;this.response=J;this._fireEvent(Xmla.EVENT_DISCOVER_SUCCESS,G);break;case Xmla.METHOD_EXECUTE:var I;var H=G.properties[Xmla.PROP_FORMAT];switch(H){case Xmla.PROP_FORMAT_TABULAR:I=new Xmla.Rowset(this.responseXML);break;case Xmla.PROP_FORMAT_MULTIDIMENSIONAL:break}G.resultset=I;this.response=I;this._fireEvent(Xmla.EVENT_EXECUTE_SUCCESS,G);break}this._fireEvent(Xmla.EVENT_SUCCESS,G)}},execute:function(F){var G=F.properties;if(!G){G={};F.properties=G}h(G,this.options.properties,false);if(!G[Xmla.PROP_CONTENT]){G[Xmla.PROP_CONTENT]=Xmla.PROP_CONTENT_SCHEMADATA}if(!G[Xmla.PROP_FORMAT]){F.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL}var H=h(F,{method:Xmla.METHOD_EXECUTE},true);return this.request(H)},executeTabular:function(F){if(!F.properties){F.properties={}}F.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_TABULAR;return this.execute(F)},executeMultiDimensional:function(F){if(!F.properties){F.properties={}}F.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(F)},discover:function(F){var G=h(F,{method:Xmla.METHOD_DISCOVER},true);if(!G.requestType){G.requestType=this.options.requestType}return this.request(G)},discoverDataSources:function(F){var G=h(F,{requestType:Xmla.DISCOVER_DATASOURCES},true);return this.discover(G)},discoverProperties:function(F){var G=h(F,{requestType:Xmla.DISCOVER_PROPERTIES},true);return this.discover(G)},discoverSchemaRowsets:function(F){var G=h(F,{requestType:Xmla.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(G)},discoverEnumerators:function(F){var G=h(F,{requestType:Xmla.DISCOVER_ENUMERATORS},true);return this.discover(G)},discoverKeywords:function(F){var G=h(F,{requestType:Xmla.DISCOVER_KEYWORDS},true);return this.discover(G)},discoverLiterals:function(F){var G=h(F,{requestType:Xmla.DISCOVER_LITERALS},true);return this.discover(G)},discoverDBCatalogs:function(F){var G=h(F,{requestType:Xmla.DBSCHEMA_CATALOGS},true);return this.discover(G)},discoverDBColumns:function(F){var G=h(F,{requestType:Xmla.DBSCHEMA_COLUMNS},true);return this.discover(G)},discoverDBProviderTypes:function(F){var G=h(F,{requestType:Xmla.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(G)},discoverDBSchemata:function(F){var G=h(F,{requestType:Xmla.DBSCHEMA_SCHEMATA},true);return this.discover(G)},discoverDBTables:function(F){var G=h(F,{requestType:Xmla.DBSCHEMA_TABLES},true);return this.discover(G)},discoverDBTablesInfo:function(F){var G=h(F,{requestType:Xmla.DBSCHEMA_TABLES_INFO},true);return this.discover(G)},discoverMDActions:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_ACTIONS},true);return this.discover(G)},discoverMDCubes:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_CUBES},true);return this.discover(G)},discoverMDDimensions:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_DIMENSIONS},true);return this.discover(G)},discoverMDFunctions:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_FUNCTIONS},true);return this.discover(G)},discoverMDHierarchies:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_HIERARCHIES},true);return this.discover(G)},discoverMDLevels:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_LEVELS},true);return this.discover(G)},discoverMDMeasures:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_MEASURES},true);return this.discover(G)},discoverMDMembers:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_MEMBERS},true);return this.discover(G)},discoverMDProperties:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_PROPERTIES},true);return this.discover(G)},discoverMDSets:function(F){var G=h(F,{requestType:Xmla.MDSCHEMA_SETS},true);return this.discover(G)}};function x(J){var G=o(J,B,c,"complexType"),I=G.length,H,F;for(F=0;F<I;F+=1){H=G.item(F);if(H.getAttribute("name")==="row"){return H}}return null}Xmla.Rowset=function(G,F){this._node=G;this._type=F;this._initData();return this};Xmla.Rowset.MD_DIMTYPE_UNKNOWN=0;Xmla.Rowset.MD_DIMTYPE_TIME=1;Xmla.Rowset.MD_DIMTYPE_MEASURE=2;Xmla.Rowset.MD_DIMTYPE_OTHER=3;Xmla.Rowset.MD_DIMTYPE_QUANTITATIVE=5;Xmla.Rowset.MD_DIMTYPE_ACCOUNTS=6;Xmla.Rowset.MD_DIMTYPE_CUSTOMERS=7;Xmla.Rowset.MD_DIMTYPE_PRODUCTS=8;Xmla.Rowset.MD_DIMTYPE_SCENARIO=9;Xmla.Rowset.MD_DIMTYPE_UTILIY=10;Xmla.Rowset.MD_DIMTYPE_CURRENCY=11;Xmla.Rowset.MD_DIMTYPE_RATES=12;Xmla.Rowset.MD_DIMTYPE_CHANNEL=13;Xmla.Rowset.MD_DIMTYPE_PROMOTION=14;Xmla.Rowset.MD_DIMTYPE_ORGANIZATION=15;Xmla.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;Xmla.Rowset.MD_DIMTYPE_GEOGRAPHY=17;Xmla.Rowset.MD_STRUCTURE_FULLYBALANCED=0;Xmla.Rowset.MD_STRUCTURE_RAGGEDBALANCED=1;Xmla.Rowset.MD_STRUCTURE_UNBALANCED=2;Xmla.Rowset.MD_STRUCTURE_NETWORK=3;Xmla.Rowset.MD_USER_DEFINED=1;Xmla.Rowset.MD_SYSTEM_ENABLED=2;Xmla.Rowset.MD_SYSTEM_INTERNAL=4;Xmla.Rowset.KEYS={};Xmla.Rowset.KEYS[Xmla.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_COLUMNS]=["TABLE_CATALOG","TABLE_NAME","COLUMN_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_PROVIDER_TYPES]=["TYPE_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_SCHEMATA]=["CATALOG_NAME","SCHEMA_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES]=["TABLE_CATALOG","TABLE_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES_INFO]=["TABLE_CATALOG","TABLE_NAME"];Xmla.Rowset.KEYS[Xmla.DISCOVER_DATASOURCES]=["DataSourceName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_KEYWORDS]=["Keyword"];Xmla.Rowset.KEYS[Xmla.DISCOVER_LITERALS]=["LiteralName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_PROPERTIES]=["PropertyName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_SCHEMA_ROWSETS]=["SchemaName"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_ACTIONS]=["CATALOG_NAME","CUBE_NAME","ACTION_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_CUBES]=["CATALOG_NAME","CUBE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_FUNCTIONS]=["FUNCTION_NAME","PARAMETER_LIST"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_LEVELS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEASURES]=["CATALOG_NAME","CUBE_NAME","MEASURE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEMBERS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME","MEMBER_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_PROPERTIES]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_SETS]=[];Xmla.Rowset.prototype={_node:null,_type:null,_row:null,_rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(){this._rows=o(this._node,b,null,"row");this.numRows=this._rows?this._rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var M=x(this._node);if(M){var R=o(M,B,c,"sequence").item(0),J=R.childNodes,L=J.length,P,F,Q,N,I,O,G;for(var K=0;K<L;K+=1){P=J.item(K);if(P.nodeType!==1){continue}F=p(P,k,E,"field");Q=P.getAttribute("name");O=P.getAttribute("type");if(O===null&&this._row){var H=this._row.getElementsByTagName(Q);if(H.length){O=p(H.item(0),C,D,"type")}}if(!O&&this._type==Xmla.DISCOVER_SCHEMA_ROWSETS&&Q==="Restrictions"){O="Restrictions"}N=P.getAttribute("minOccurs");if(N){N=parseInt(N,10)}else{N=1}I=P.getAttribute("maxOccurs");if(I){if(I==="unbounded"){I=Infinity}else{N=parseInt(I,10)}}else{I=1}G=this._getValueConverter(O);this.fields[F]={name:Q,label:F,index:this._fieldCount++,type:O,jsType:G.jsType,minOccurs:N,maxOccurs:I,getter:this._createFieldGetter(Q,G.func,N,I)};this.fieldOrder.push(F)}}else{Xmla.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",this._node)._throw()}},_boolConverter:function(F){return F==="true"?true:false},_intConverter:function(F){return parseInt(F,10)},_floatConverter:function(F){return parseFloat(F,10)},_textConverter:function(F){return F},_dateTimeConverter:function(F){return Date.parse(F)},_restrictionsConverter:function(F){return F},_arrayConverter:function(H,G){var F=[],J=H.length,K;for(var I=0;I<J;I+=1){K=H.item(I);F.push(G(this._elementText(K)))}return F},_elementText:function(G){if(G.innerText){return G.innerText}else{if(G.textContent){return G.textContent}else{if(G.normalize){G.normalize();if(G.firstChild){return G.firstChild.data}else{return null}}else{var J="",I=G.childNodes,H=I.length;for(var F=0;F<H;F+=1){J+=I.item(F).data}return J}}}},_getValueConverter:function(G){var F={};switch(G){case"xsd:boolean":F.func=this._boolConverter;F.jsType="boolean";break;case"xsd:decimal":case"xsd:double":case"xsd:float":F.func=this._floatConverter;F.jsType="number";break;case"xsd:int":case"xsd:integer":case"xsd:nonPositiveInteger":case"xsd:negativeInteger":case"xsd:nonNegativeInteger":case"xsd:positiveInteger":case"xsd:short":case"xsd:byte":case"xsd:long":case"xsd:unsignedLong":case"xsd:unsignedInt":case"xsd:unsignedShort":case"xsd:unsignedByte":F.func=this._intConverter;F.jsType="number";break;case"xsd:string":F.func=this._textConverter;F.jsType="string";break;case"xsd:dateTime":F.func=this._dateTimeConverter;F.jsType="object";break;case"Restrictions":F.func=this._restrictionsConverter;F.jsType="object";break;default:F.func=this._textConverter;F.jsType="object";break}return F},_createFieldGetter:function(K,G,J,H){var I=this;var F;if(H===1){if(J===1){F=function(){var L=o(this._row,b,null,K);return G(I._elementText(L.item(0)))}}else{if(J===0){F=function(){var L=o(this._row,b,null,K);if(L.length){return G(I._elementText(L.item(0)))}else{return null}}}}}else{if(J===1){F=function(){var L=o(this._row,b,null,K);return I._arrayConverter(L,G)}}else{if(J===0){F=function(){var L=o(this._row,b,null,K);if(L.length){return I._arrayConverter(L,G)}else{return null}}}}}return F},getType:function(){return this._type},getFields:function(){var I=[],H=this._fieldCount,F=this.fieldOrder;for(var G=0;G<H;G+=1){I[G]=this.fieldDef(F[G])}return I},getFieldNames:function(){var H=[];for(var F=0,G=this.fieldCount();F<G;F+=1){H[F]=this.fieldOrder[F]}return H},hasMoreRows:function(){return this.numRows>this.rowIndex},next:function(){this.rowIndex+=1;this._row=this._rows.item(this.rowIndex)},curr:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this._row=(this.hasMoreRows())?this._rows.item(this.rowIndex):null},fieldDef:function(F){var G=this.fields[F];if(!G){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",F)._throw()}return G},fieldIndex:function(F){var G=this.fieldDef(F);return G.index},fieldName:function(F){var G=this.fieldOrder[F];if(!G){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",F)._throw()}return G},fieldVal:function(F){if(typeof(F)==="number"){F=this.fieldName(F)}var G=this.fieldDef(F);return G.getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this._node=null;this._row=null;this._rows=null},readAsArray:function(){var I=[],F=this.fields,H,G;for(H in F){if(F.hasOwnProperty(H)){G=F[H];I[G.index]=G.getter.call(this)}}return I},fetchAsArray:function(){var F;if(this.hasMoreRows()){F=this.readAsArray();this.next()}else{F=false}return F},readAsObject:function(){var G={},F=this.fields,I,H;for(I in F){if(F.hasOwnProperty(I)){H=F[I];G[I]=H.getter.call(this)}}return G},fetchAsObject:function(){var F;if(this.hasMoreRows()){F=this.readAsObject();this.next()}else{F=false}return F},fetchCustom:function(G){var F;if(this.hasMoreRows()){F=G.call(this);this.next()}else{F=false}return F},fetchAllAsArray:function(F){var G;if(!F){F=[]}while((G=this.fetchAsArray())){F.push(G)}return F},fetchAllAsObject:function(F){var G;if(!F){F=[]}while((G=this.fetchAsObject())){F.push(G)}return F},fetchAllCustom:function(G,F){var H;if(!G){G=[]}while((H=this.fetchCustom(F))){G.push(H)}return G},mapAsObject:function(F,M,O){var I,N,G,J,K=M.length,L=K-1,H=F;for(J=0;J<K;J+=1){I=M[J];N=O[I];G=H[N];if(G){if(J===L){if(G instanceof Array){G.push(O)}else{H[N]=[G,O]}}else{H=G}}else{if(J===L){H[N]=O}else{H=H[N]={}}}}},mapAllAsObject:function(F,G){if(!G){G={}}if(!F){F=this.getKey()}var H;while(H=this.fetchAsObject()){this.mapAsObject(G,F,H)}return G},getKey:function(){var F;if(this._type){F=Xmla.Rowset.KEYS[this._type]}else{F=this.getFieldNames()}return F}};Xmla.Exception=function(G,I,H,F,K,J){this.type=G;this.code=I;this.message=H;this.source=K;this.helpfile=F;this.data=J;return this};Xmla.Exception.TYPE_WARNING="warning";Xmla.Exception.TYPE_ERROR="error";var e="http://code.google.com/p/xmla4js/wiki/ExceptionCodes";Xmla.Exception.MISSING_REQUEST_TYPE_CDE=-1;Xmla.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";Xmla.Exception.MISSING_REQUEST_TYPE_HLP=e+"#"+Xmla.Exception.MISSING_REQUEST_TYPE_CDE+"_"+Xmla.Exception.MISSING_REQUEST_TYPE_MSG;Xmla.Exception.MISSING_STATEMENT_CDE=-2;Xmla.Exception.MISSING_STATEMENT_MSG="Missing_Statement";Xmla.Exception.MISSING_STATEMENT_HLP=e+"#"+Xmla.Exception.MISSING_STATEMENT_CDE+"_"+Xmla.Exception.MISSING_STATEMENT_MSG;Xmla.Exception.MISSING_URL_CDE=-3;Xmla.Exception.MISSING_URL_MSG="Missing_URL";Xmla.Exception.MISSING_URL_HLP=e+"#"+Xmla.Exception.MISSING_URL_CDE+"_"+Xmla.Exception.MISSING_URL_MSG;Xmla.Exception.NO_EVENTS_SPECIFIED_CDE=-4;Xmla.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";Xmla.Exception.NO_EVENTS_SPECIFIED_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.WRONG_EVENTS_FORMAT_CDE=-5;Xmla.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";Xmla.Exception.WRONG_EVENTS_FORMAT_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.UNKNOWN_EVENT_CDE=-6;Xmla.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";Xmla.Exception.UNKNOWN_EVENT_HLP=e+"#"+Xmla.Exception.UNKNOWN_EVENT_CDE+"_"+Xmla.Exception.UNKNOWN_EVENT_MSG;Xmla.Exception.INVALID_EVENT_HANDLER_CDE=-7;Xmla.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";Xmla.Exception.INVALID_EVENT_HANDLER_HLP=e+"#"+Xmla.Exception.INVALID_EVENT_HANDLER_CDE+"_"+Xmla.Exception.INVALID_EVENT_HANDLER_MSG;Xmla.Exception.ERROR_PARSING_RESPONSE_CDE=-8;Xmla.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";Xmla.Exception.ERROR_PARSING_RESPONSE_HLP=e+"#"+Xmla.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+Xmla.Exception.ERROR_PARSING_RESPONSE_MSG;Xmla.Exception.INVALID_FIELD_CDE=-9;Xmla.Exception.INVALID_FIELD_MSG="Invalid_Field";Xmla.Exception.INVALID_FIELD_HLP=e+"#"+Xmla.Exception.INVALID_FIELD_CDE+"_"+Xmla.Exception.INVALID_FIELD_MSG;Xmla.Exception.HTTP_ERROR_CDE=-10;Xmla.Exception.HTTP_ERROR_MSG="HTTP Error";Xmla.Exception.HTTP_ERROR_HLP=e+"#"+Xmla.Exception.HTTP_ERROR_CDE+"_"+Xmla.Exception.HTTP_ERROR_MSG;Xmla.Exception._newError=function(F,H,G){return new Xmla.Exception(Xmla.Exception.TYPE_ERROR,Xmla.Exception[F+"_CDE"],Xmla.Exception[F+"_MSG"],Xmla.Exception[F+"_HLP"],H,G)};Xmla.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this}}}());