var Xmla;(function(){var A="http://schemas.xmlsoap.org/soap/",d=A+"envelope/",h="SOAP-ENV",m="xmlns:"+h+'="'+d+'"',w=h+':encodingStyle="'+A+'encoding/"',k="urn:schemas-microsoft-com:",x=k+"xml-analysis",j='xmlns="'+x+'"',F="sql",l=k+"xml-sql",C="http://www.w3.org/2001/XMLSchema",c="xsd",D="http://www.w3.org/2001/XMLSchema-instance",E="xsi",b=x+":rowset",p=x+":mddataset",a=window.ActiveXObject?true:false;function g(H){var J,G=false,I=function(){G=true;switch(J.readyState){case 0:H.aborted(J);break;case 4:if(J.status===200){H.complete(J)}else{H.error(Xmla.Exception._newError("HTTP_ERROR","_ajax",H))}break}};if(a){J=new ActiveXObject("MSXML2.XMLHTTP.3.0")}else{J=new XMLHttpRequest()}if(H.username&&H.password){J.open("POST",H.url,H.async,H.username,H.password)}else{J.open("POST",H.url,H.async)}J.onreadystatechange=I;J.setRequestHeader("Content-Type","text/xml");J.send(H.data);if(!H.async&&!G){I.call(J)}return J}function B(G){return typeof(G)==="undefined"}function s(G){return G.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var q=document.getElementsByTagNameNS?function(I,H,J,G){return I.getElementsByTagNameNS(H,G)}:function(I,H,J,G){if(J){return I.getElementsByTagName(J+":"+G)}else{return I.getElementsByTagName(G)}};var r=document.documentElement.getAttributeNS?function(H,I,J,G){return H.getAttributeNS(I,G)}:function(H,I,J,G){if(J){return H.getAttribute(J+":"+G)}else{return H.getAttribute(G)}};function f(H){if(H.innerText){return H.innerText}else{if(H.textContent){return H.textContent}else{if(H.normalize){H.normalize();if(H.firstChild){return H.firstChild.data}else{return null}}else{var K="",J=H.childNodes,I=J.length;for(var G=0;G<I;G+=1){K+=J.item(G).data}return K}}}}function v(G,M,K,I){if(!I){I=""}var L,J,N,O,P,H="\n"+I+"<"+G+">";if(K){H+="\n"+I+" <"+M+">";for(O in K){if(K.hasOwnProperty(O)){P=K[O];H+="\n"+I+"  <"+O+">";if(typeof(P)==="array"){for(N,J=0,L=P.length;J<L;J+=1){N=P[J];H+="<Value>"+s(N)+"</Value>"}}else{H+=s(P)}H+="</"+O+">"}}H+="\n"+I+" </"+M+">"}H+="\n"+I+"</"+G+">";return H}var o="RequestType";function z(G){var I="",J=G.method,H=null;I+="\n<"+h+":Envelope "+m+" "+w+">\n <"+h+":Body>\n  <"+J+" "+j+" "+w+">";switch(J){case Xmla.METHOD_DISCOVER:if(G.requestType){I+="\n   <"+o+">"+G.requestType+"</"+o+">"+v("Restrictions","RestrictionList",G.restrictions,"   ")+v("Properties","PropertyList",G.properties,"   ")}else{H=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",G)}break;case Xmla.METHOD_EXECUTE:if(G.statement){I+="\n   <Command>\n    <Statement>"+G.statement+"</Statement>\n   </Command>"+v("Properties","PropertyList",G.properties,"   ")}else{H=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",G)}break;default:}if(H!==null){H._throw()}I+="\n  </"+J+">\n </"+h+":Body>\n</"+h+":Envelope>";return I}function i(H,I,G){if(I&&(!H)){H={}}for(var J in I){if(I.hasOwnProperty(J)){if(G||B(H[J])){H[J]=I[J]}}}return H}Xmla=function(G){this.listeners={};this.listeners[Xmla.EVENT_REQUEST]=[];this.listeners[Xmla.EVENT_SUCCESS]=[];this.listeners[Xmla.EVENT_ERROR]=[];this.listeners[Xmla.EVENT_DISCOVER]=[];this.listeners[Xmla.EVENT_DISCOVER_SUCCESS]=[];this.listeners[Xmla.EVENT_DISCOVER_ERROR]=[];this.listeners[Xmla.EVENT_EXECUTE]=[];this.listeners[Xmla.EVENT_EXECUTE_SUCCESS]=[];this.listeners[Xmla.EVENT_EXECUTE_ERROR]=[];this.options=i(i({},Xmla.defaultOptions,true),G,true);return this};Xmla.defaultOptions={requestTimeout:30000,async:false};Xmla.METHOD_DISCOVER="Discover";Xmla.METHOD_EXECUTE="Execute";var t="DISCOVER_";var n="MDSCHEMA_";var u="DBSCHEMA_";Xmla.DISCOVER_DATASOURCES=t+"DATASOURCES";Xmla.DISCOVER_PROPERTIES=t+"PROPERTIES";Xmla.DISCOVER_SCHEMA_ROWSETS=t+"SCHEMA_ROWSETS";Xmla.DISCOVER_ENUMERATORS=t+"ENUMERATORS";Xmla.DISCOVER_KEYWORDS=t+"KEYWORDS";Xmla.DISCOVER_LITERALS=t+"LITERALS";Xmla.DBSCHEMA_CATALOGS=u+"CATALOGS";Xmla.DBSCHEMA_COLUMNS=u+"COLUMNS";Xmla.DBSCHEMA_PROVIDER_TYPES=u+"PROVIDER_TYPES";Xmla.DBSCHEMA_SCHEMATA=u+"SCHEMATA";Xmla.DBSCHEMA_TABLES=u+"TABLES";Xmla.DBSCHEMA_TABLES_INFO=u+"TABLES_INFO";Xmla.MDSCHEMA_ACTIONS=n+"ACTIONS";Xmla.MDSCHEMA_CUBES=n+"CUBES";Xmla.MDSCHEMA_DIMENSIONS=n+"DIMENSIONS";Xmla.MDSCHEMA_FUNCTIONS=n+"FUNCTIONS";Xmla.MDSCHEMA_HIERARCHIES=n+"HIERARCHIES";Xmla.MDSCHEMA_LEVELS=n+"LEVELS";Xmla.MDSCHEMA_MEASURES=n+"MEASURES";Xmla.MDSCHEMA_MEMBERS=n+"MEMBERS";Xmla.MDSCHEMA_PROPERTIES=n+"PROPERTIES";Xmla.MDSCHEMA_SETS=n+"SETS";Xmla.EVENT_REQUEST="request";Xmla.EVENT_SUCCESS="success";Xmla.EVENT_ERROR="error";Xmla.EVENT_EXECUTE="execute";Xmla.EVENT_EXECUTE_SUCCESS="executesuccess";Xmla.EVENT_EXECUTE_ERROR="executeerror";Xmla.EVENT_DISCOVER="discover";Xmla.EVENT_DISCOVER_SUCCESS="discoversuccess";Xmla.EVENT_DISCOVER_ERROR="discovererror";Xmla.EVENT_GENERAL=[Xmla.EVENT_REQUEST,Xmla.EVENT_SUCCESS,Xmla.EVENT_ERROR];Xmla.EVENT_DISCOVER_ALL=[Xmla.EVENT_DISCOVER,Xmla.EVENT_DISCOVER_SUCCESS,Xmla.EVENT_DISCOVER_ERROR];Xmla.EVENT_EXECUTE_ALL=[Xmla.EVENT_EXECUTE,Xmla.EVENT_EXECUTE_SUCCESS,Xmla.EVENT_EXECUTE_ERROR];Xmla.EVENT_ALL=[].concat(Xmla.EVENT_GENERAL,Xmla.EVENT_DISCOVER_ALL,Xmla.EVENT_EXECUTE_ALL);Xmla.PROP_DATASOURCEINFO="DataSourceInfo";Xmla.PROP_CATALOG="Catalog";Xmla.PROP_CUBE="Cube";Xmla.PROP_FORMAT="Format";Xmla.PROP_FORMAT_TABULAR="Tabular";Xmla.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";Xmla.PROP_AXISFORMAT="AxisFormat";Xmla.PROP_AXISFORMAT_TUPLE="TupleFormat";Xmla.PROP_AXISFORMAT_CLUSTER="ClusterFormat";Xmla.PROP_AXISFORMAT_CUSTOM="CustomFormat";Xmla.PROP_CONTENT="Content";Xmla.PROP_CONTENT_DATA="Data";Xmla.PROP_CONTENT_NONE="None";Xmla.PROP_CONTENT_SCHEMA="Schema";Xmla.PROP_CONTENT_SCHEMADATA="SchemaData";Xmla.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXML:null,setOptions:function(G){i(this.options,G,true)},addListener:function(L){var J=L.events;if(!J){Xmla.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",L)._throw()}if(typeof(J)==="string"){if(J==="all"){J=Xmla.EVENT_ALL}else{J=J.split(",")}}if(!(J instanceof Array)){Xmla.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",L)._throw()}var I=J.length;var G,K;for(var H=0;H<I;H+=1){G=J[H].replace(/\s+/g,"");K=this.listeners[G];if(!K){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",L)._throw()}if(typeof(L.handler)=="function"){if(!L.scope){L.scope=window}K.push(L)}else{Xmla.Exception._newError("INVALID_EVENT_HANDLER","Xmla.addListener",L)._throw()}}},_fireEvent:function(L,O,H){var M=this.listeners[L];if(!M){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",L)._throw()}var K=M.length;var G=true;if(K){var I,N;for(var J=0;J<K;J+=1){I=M[J];N=I.handler.call(I.scope,L,O,this);if(H&&N===false){G=false;break}}}else{if(L==="error"){O.exception._throw()}}return G},request:function(H){var J,I=this;this.response=null;this.responseText=null;this.responseXML=null;if(!H.url){if(this.options.url){H.url=this.options.url}else{J=Xmla.Exception._newError("MISSING_URL","Xmla.request",H);J._throw()}}H.properties=i(H.properties,this.options.properties,false);H.restrictions=i(H.restrictions,this.options.restrictions,false);if(B(H.async)&&!B(this.options.async)){H.async=this.options.async}if(B(H.requestTimeout)&&!B(this.options.requestTimeout)){H.requestTimeout=this.options.requestTimeout}if(!H.username&&this.options.username){H.username=this.options.username}if(!H.password&&this.options.password){H.password=this.options.password}var K=z(H);this.soapMessage=K;var L;var G={async:H.async,timeout:H.requestTimeout,data:K,error:function(M){H.exception=M;I._requestError(H)},complete:function(M){H.xhr=M;I._requestSuccess(H)},url:H.url};if(H.username){G.username=H.username}if(H.password){G.password=H.password}if(this._fireEvent(Xmla.EVENT_REQUEST,H,true)&&((H.method==Xmla.METHOD_DISCOVER&&this._fireEvent(Xmla.EVENT_DISCOVER,H))||(H.method==Xmla.METHOD_EXECUTE&&this._fireEvent(Xmla.EVENT_EXECUTE,H)))){L=g(G)}return this.response},_requestError:function(G){this._fireEvent("error",G)},_requestSuccess:function(L){var O=L.xhr;this.responseXML=O.responseXML;this.responseText=O.responseText;var G=L.method;var I=q(this.responseXML,d,h,"Fault");if(I.length){I=I.item(0);L.exception=new Xmla.Exception(Xmla.Exception.TYPE_ERROR,I.getElementsByTagName("faultcode").item(0).childNodes.item(0).data,I.getElementsByTagName("faultstring").item(0).childNodes.item(0).data,null,"_requestSuccess",L);switch(G){case Xmla.METHOD_DISCOVER:this._fireEvent(Xmla.EVENT_DISCOVER_ERROR,L);break;case Xmla.METHOD_EXECUTE:this._fireEvent(Xmla.EVENT_EXECUTE_ERROR,L);break}this._fireEvent(Xmla.EVENT_ERROR,L)}else{switch(G){case Xmla.METHOD_DISCOVER:var H=new Xmla.Rowset(this.responseXML,L.requestType);L.rowset=H;this.response=H;this._fireEvent(Xmla.EVENT_DISCOVER_SUCCESS,L);break;case Xmla.METHOD_EXECUTE:var J,M=null,K=null;var N=L.properties[Xmla.PROP_FORMAT];switch(N){case Xmla.PROP_FORMAT_TABULAR:J=M=new Xmla.Rowset(this.responseXML);break;case Xmla.PROP_FORMAT_MULTIDIMENSIONAL:J=K=new Xmla.Dataset(this.responseXML);break}L.resultset=M;L.dataset=K;this.response=J;this._fireEvent(Xmla.EVENT_EXECUTE_SUCCESS,L);break}this._fireEvent(Xmla.EVENT_SUCCESS,L)}},execute:function(G){var H=G.properties;if(!H){H={};G.properties=H}i(H,this.options.properties,false);if(!H[Xmla.PROP_CONTENT]){H[Xmla.PROP_CONTENT]=Xmla.PROP_CONTENT_SCHEMADATA}if(!H[Xmla.PROP_FORMAT]){G.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL}var I=i(G,{method:Xmla.METHOD_EXECUTE},true);return this.request(I)},executeTabular:function(G){if(!G.properties){G.properties={}}G.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_TABULAR;return this.execute(G)},executeMultiDimensional:function(G){if(!G.properties){G.properties={}}G.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(G)},discover:function(G){var H=i(G,{method:Xmla.METHOD_DISCOVER},true);if(!H.requestType){H.requestType=this.options.requestType}return this.request(H)},discoverDataSources:function(G){var H=i(G,{requestType:Xmla.DISCOVER_DATASOURCES},true);return this.discover(H)},discoverProperties:function(G){var H=i(G,{requestType:Xmla.DISCOVER_PROPERTIES},true);return this.discover(H)},discoverSchemaRowsets:function(G){var H=i(G,{requestType:Xmla.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(H)},discoverEnumerators:function(G){var H=i(G,{requestType:Xmla.DISCOVER_ENUMERATORS},true);return this.discover(H)},discoverKeywords:function(G){var H=i(G,{requestType:Xmla.DISCOVER_KEYWORDS},true);return this.discover(H)},discoverLiterals:function(G){var H=i(G,{requestType:Xmla.DISCOVER_LITERALS},true);return this.discover(H)},discoverDBCatalogs:function(G){var H=i(G,{requestType:Xmla.DBSCHEMA_CATALOGS},true);return this.discover(H)},discoverDBColumns:function(G){var H=i(G,{requestType:Xmla.DBSCHEMA_COLUMNS},true);return this.discover(H)},discoverDBProviderTypes:function(G){var H=i(G,{requestType:Xmla.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(H)},discoverDBSchemata:function(G){var H=i(G,{requestType:Xmla.DBSCHEMA_SCHEMATA},true);return this.discover(H)},discoverDBTables:function(G){var H=i(G,{requestType:Xmla.DBSCHEMA_TABLES},true);return this.discover(H)},discoverDBTablesInfo:function(G){var H=i(G,{requestType:Xmla.DBSCHEMA_TABLES_INFO},true);return this.discover(H)},discoverMDActions:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_ACTIONS},true);return this.discover(H)},discoverMDCubes:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_CUBES},true);return this.discover(H)},discoverMDDimensions:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_DIMENSIONS},true);return this.discover(H)},discoverMDFunctions:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_FUNCTIONS},true);return this.discover(H)},discoverMDHierarchies:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_HIERARCHIES},true);return this.discover(H)},discoverMDLevels:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_LEVELS},true);return this.discover(H)},discoverMDMeasures:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_MEASURES},true);return this.discover(H)},discoverMDMembers:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_MEMBERS},true);return this.discover(H)},discoverMDProperties:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_PROPERTIES},true);return this.discover(H)},discoverMDSets:function(G){var H=i(G,{requestType:Xmla.MDSCHEMA_SETS},true);return this.discover(H)}};function y(K){var H=q(K,C,c,"complexType"),J=H.length,I,G;for(G=0;G<J;G+=1){I=H.item(G);if(I.getAttribute("name")==="row"){return I}}return null}Xmla.Rowset=function(H,G){this._node=H;this._type=G;this._initData();return this};Xmla.Rowset.MD_DIMTYPE_UNKNOWN=0;Xmla.Rowset.MD_DIMTYPE_TIME=1;Xmla.Rowset.MD_DIMTYPE_MEASURE=2;Xmla.Rowset.MD_DIMTYPE_OTHER=3;Xmla.Rowset.MD_DIMTYPE_QUANTITATIVE=5;Xmla.Rowset.MD_DIMTYPE_ACCOUNTS=6;Xmla.Rowset.MD_DIMTYPE_CUSTOMERS=7;Xmla.Rowset.MD_DIMTYPE_PRODUCTS=8;Xmla.Rowset.MD_DIMTYPE_SCENARIO=9;Xmla.Rowset.MD_DIMTYPE_UTILIY=10;Xmla.Rowset.MD_DIMTYPE_CURRENCY=11;Xmla.Rowset.MD_DIMTYPE_RATES=12;Xmla.Rowset.MD_DIMTYPE_CHANNEL=13;Xmla.Rowset.MD_DIMTYPE_PROMOTION=14;Xmla.Rowset.MD_DIMTYPE_ORGANIZATION=15;Xmla.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;Xmla.Rowset.MD_DIMTYPE_GEOGRAPHY=17;Xmla.Rowset.MD_STRUCTURE_FULLYBALANCED=0;Xmla.Rowset.MD_STRUCTURE_RAGGEDBALANCED=1;Xmla.Rowset.MD_STRUCTURE_UNBALANCED=2;Xmla.Rowset.MD_STRUCTURE_NETWORK=3;Xmla.Rowset.MD_USER_DEFINED=1;Xmla.Rowset.MD_SYSTEM_ENABLED=2;Xmla.Rowset.MD_SYSTEM_INTERNAL=4;Xmla.Rowset.KEYS={};Xmla.Rowset.KEYS[Xmla.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_COLUMNS]=["TABLE_CATALOG","TABLE_NAME","COLUMN_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_PROVIDER_TYPES]=["TYPE_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_SCHEMATA]=["CATALOG_NAME","SCHEMA_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES]=["TABLE_CATALOG","TABLE_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES_INFO]=["TABLE_CATALOG","TABLE_NAME"];Xmla.Rowset.KEYS[Xmla.DISCOVER_DATASOURCES]=["DataSourceName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_KEYWORDS]=["Keyword"];Xmla.Rowset.KEYS[Xmla.DISCOVER_LITERALS]=["LiteralName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_PROPERTIES]=["PropertyName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_SCHEMA_ROWSETS]=["SchemaName"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_ACTIONS]=["CATALOG_NAME","CUBE_NAME","ACTION_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_CUBES]=["CATALOG_NAME","CUBE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_FUNCTIONS]=["FUNCTION_NAME","PARAMETER_LIST"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_LEVELS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEASURES]=["CATALOG_NAME","CUBE_NAME","MEASURE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEMBERS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME","MEMBER_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_PROPERTIES]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_SETS]=[];Xmla.Rowset.prototype={_node:null,_type:null,_row:null,_rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(){this._rows=q(this._node,b,null,"row");this.numRows=this._rows?this._rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var N=y(this._node);if(N){var S=q(N,C,c,"sequence").item(0),K=S.childNodes,M=K.length,Q,G,R,O,J,P,H;for(var L=0;L<M;L+=1){Q=K.item(L);if(Q.nodeType!==1){continue}G=r(Q,l,F,"field");R=Q.getAttribute("name");P=Q.getAttribute("type");if(P===null&&this._row){var I=this._row.getElementsByTagName(R);if(I.length){P=r(I.item(0),D,E,"type")}}if(!P&&this._type==Xmla.DISCOVER_SCHEMA_ROWSETS&&R==="Restrictions"){P="Restrictions"}O=Q.getAttribute("minOccurs");if(O){O=parseInt(O,10)}else{O=1}J=Q.getAttribute("maxOccurs");if(J){if(J==="unbounded"){J=Infinity}else{O=parseInt(J,10)}}else{J=1}H=this._getValueConverter(P);this.fields[G]={name:R,label:G,index:this._fieldCount++,type:P,jsType:H.jsType,minOccurs:O,maxOccurs:J,getter:this._createFieldGetter(R,H.func,O,J)};this.fieldOrder.push(G)}}else{Xmla.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",this._node)._throw()}},_boolConverter:function(G){return G==="true"?true:false},_intConverter:function(G){return parseInt(G,10)},_floatConverter:function(G){return parseFloat(G,10)},_textConverter:function(G){return G},_dateTimeConverter:function(G){return Date.parse(G)},_restrictionsConverter:function(G){return G},_arrayConverter:function(I,H){var G=[],K=I.length,L;for(var J=0;J<K;J+=1){L=I.item(J);G.push(H(f(L)))}return G},_getValueConverter:function(H){var G={};switch(H){case"xsd:boolean":G.func=this._boolConverter;G.jsType="boolean";break;case"xsd:decimal":case"xsd:double":case"xsd:float":G.func=this._floatConverter;G.jsType="number";break;case"xsd:int":case"xsd:integer":case"xsd:nonPositiveInteger":case"xsd:negativeInteger":case"xsd:nonNegativeInteger":case"xsd:positiveInteger":case"xsd:short":case"xsd:byte":case"xsd:long":case"xsd:unsignedLong":case"xsd:unsignedInt":case"xsd:unsignedShort":case"xsd:unsignedByte":G.func=this._intConverter;G.jsType="number";break;case"xsd:string":G.func=this._textConverter;G.jsType="string";break;case"xsd:dateTime":G.func=this._dateTimeConverter;G.jsType="object";break;case"Restrictions":G.func=this._restrictionsConverter;G.jsType="object";break;default:G.func=this._textConverter;G.jsType="object";break}return G},_createFieldGetter:function(L,H,K,I){var J=this;var G;if(I===1){if(K===1){G=function(){var M=q(this._row,b,null,L);return H(f(M.item(0)))}}else{if(K===0){G=function(){var M=q(this._row,b,null,L);if(M.length){return H(f(M.item(0)))}else{return null}}}}}else{if(K===1){G=function(){var M=q(this._row,b,null,L);return J._arrayConverter(M,H)}}else{if(K===0){G=function(){var M=q(this._row,b,null,L);if(M.length){return J._arrayConverter(M,H)}else{return null}}}}}return G},getType:function(){return this._type},getFields:function(){var J=[],I=this._fieldCount,G=this.fieldOrder;for(var H=0;H<I;H+=1){J[H]=this.fieldDef(G[H])}return J},getFieldNames:function(){var I=[];for(var G=0,H=this.fieldCount();G<H;G+=1){I[G]=this.fieldOrder[G]}return I},hasMoreRows:function(){return this.numRows>this.rowIndex},next:function(){this.rowIndex+=1;this._row=this._rows.item(this.rowIndex);return this.rowIndex},curr:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this._row=(this.hasMoreRows())?this._rows.item(this.rowIndex):null},fieldDef:function(G){var H=this.fields[G];if(!H){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",G)._throw()}return H},fieldIndex:function(G){var H=this.fieldDef(G);return H.index},fieldName:function(G){var H=this.fieldOrder[G];if(!H){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",G)._throw()}return H},fieldVal:function(G){if(typeof(G)==="number"){G=this.fieldName(G)}var H=this.fieldDef(G);return H.getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this._node=null;this._row=null;this._rows=null},readAsArray:function(){var J=[],G=this.fields,I,H;for(I in G){if(G.hasOwnProperty(I)){H=G[I];J[H.index]=H.getter.call(this)}}return J},fetchAsArray:function(){var G;if(this.hasMoreRows()){G=this.readAsArray();this.next()}else{G=false}return G},readAsObject:function(){var H={},G=this.fields,J,I;for(J in G){if(G.hasOwnProperty(J)){I=G[J];H[J]=I.getter.call(this)}}return H},fetchAsObject:function(){var G;if(this.hasMoreRows()){G=this.readAsObject();this.next()}else{G=false}return G},fetchCustom:function(H){var G;if(this.hasMoreRows()){G=H.call(this);this.next()}else{G=false}return G},fetchAllAsArray:function(G){var H;if(!G){G=[]}while((H=this.fetchAsArray())){G.push(H)}return G},fetchAllAsObject:function(G){var H;if(!G){G=[]}while((H=this.fetchAsObject())){G.push(H)}return G},fetchAllCustom:function(H,G){var I;if(!H){H=[]}while((I=this.fetchCustom(G))){H.push(I)}return H},mapAsObject:function(G,N,P){var J,O,H,K,L=N.length,M=L-1,I=G;for(K=0;K<L;K+=1){J=N[K];O=P[J];H=I[O];if(H){if(K===M){if(H instanceof Array){H.push(P)}else{I[O]=[H,P]}}else{I=H}}else{if(K===M){I[O]=P}else{I=I[O]={}}}}},mapAllAsObject:function(G,H){if(!H){H={}}if(!G){G=this.getKey()}var I;while(I=this.fetchAsObject()){this.mapAsObject(H,G,I)}return H},getKey:function(){var G;if(this._type){G=Xmla.Rowset.KEYS[this._type]}else{G=this.getFieldNames()}return G}};Xmla.Dataset=function(G){this._initDataset(G);return this};Xmla.Dataset.AXIS_COLUMNS="Axis0";Xmla.Dataset.AXIS_ROWS="Axis1";Xmla.Dataset.AXIS_PAGES="Axis2";Xmla.Dataset.AXIS_SECTIONS="Axis3";Xmla.Dataset.AXIS_CHAPTERS="Axis4";Xmla.Dataset.AXIS_SLICER="SlicerAxis";Xmla.Dataset.prototype={_root:null,_initDataset:function(M){var I=q(M,p,"","root");if(I.length){I=I.item(0);this._root=I}else{Xmla.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset._initData",this._node)._throw()}this.cubeName=f(q(I,p,"","CubeName").item(0));this.axes={};var L,H,J=q(I,p,"","Axis"),G=J.length;for(var K=0;K<G;K++){H=J.item(K);L=new Xmla.Dataset.Axis(H);this.axes[L.name]=L}},close:function(){this._root=null},};Xmla.Dataset.Axis=function(G){this._initAxis(G);return this};Xmla.Dataset.Axis.prototype={_tuples:null,_members:null,numTuples:null,numHierarchies:null,_tupleIndex:null,_hierarchyOrder:null,_hierachies:null,_initAxis:function(H){this.name=H.getAttribute("name");this._tuples=q(H,p,"","Tuple");this.numTuples=this._tuples.length;this.reset();this._hierarchies={};this._hierarchyOrder=[];var K,I,G=this._members.length;this.numHierarchies=G;for(var J=0;J<G;J++){K=this._members.item(J);I=K.getAttribute("Hierarchy");this._hierarchies[I]=J;this._hierarchyOrder[J]=I}},_getMembers:function(){if(this.tupleIndex<this.numTuples){return q(this._tuples.item(this.tupleIndex),p,"","Member")}else{return null}},reset:function(){this.tupleIndex=0;this._members=(this.hasMoreTuples())?this._getMembers():null},hasMoreTuples:function(){return this.numTuples>this.tupleIndex},next:function(){this.tupleIndex+=1;this._members=this._getMembers();return this.tupleIndex},tupleCount:function(){return this.numTuples},hierarchyCount:function(){return this.numHierarchies},hierarchyIndex:function(G){return this._hierarchies[G]},hierarchy:function(G){return this._hierarchyOrder[G]},member:function(G){var J,I,N={};switch(typeof(G)){case"string":J=this.hierarchyIndex(G);I=G;break;case"number":I=this.hierarchy(G);J=G;break}N.hierarchy=I;N.index=J;var L=q(this._members.item(G),p,"","*"),H=L.length,M;for(var K=0;K<H;K++){M=L.item(K);N[M.tagName]=f(M)}return N},readAsArray:function(){var H=[];for(var G=0;G<this.numHierarchies;G++){H[G]=this.member(G)}return H},readAsObject:function(){var G=[];for(var H=0;H<this.numHierarchies;H++){G[this._hierarchyOrder[H]]=this.member(H)}return G},fetchAsArray:function(){var G;if(this.hasMoreTuples()){G=this.readAsArray();this.next()}else{G=false}return G},fetchAsObject:function(){var G;if(this.hasMoreTuples()){G=this.readAsObject();this.next()}else{G=false}return G},fetchAllAsArray:function(G){var H;if(!G){G=[]}while((H=this.fetchAsArray())){G.push(H)}return G},fetchAllAsObject:function(G){var H;if(!G){G=[]}while((H=this.fetchAsObject())){G.push(H)}return G},};Xmla.Exception=function(H,J,I,G,L,K){this.type=H;this.code=J;this.message=I;this.source=L;this.helpfile=G;this.data=K;return this};Xmla.Exception.TYPE_WARNING="warning";Xmla.Exception.TYPE_ERROR="error";var e="http://code.google.com/p/xmla4js/wiki/ExceptionCodes";Xmla.Exception.MISSING_REQUEST_TYPE_CDE=-1;Xmla.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";Xmla.Exception.MISSING_REQUEST_TYPE_HLP=e+"#"+Xmla.Exception.MISSING_REQUEST_TYPE_CDE+"_"+Xmla.Exception.MISSING_REQUEST_TYPE_MSG;Xmla.Exception.MISSING_STATEMENT_CDE=-2;Xmla.Exception.MISSING_STATEMENT_MSG="Missing_Statement";Xmla.Exception.MISSING_STATEMENT_HLP=e+"#"+Xmla.Exception.MISSING_STATEMENT_CDE+"_"+Xmla.Exception.MISSING_STATEMENT_MSG;Xmla.Exception.MISSING_URL_CDE=-3;Xmla.Exception.MISSING_URL_MSG="Missing_URL";Xmla.Exception.MISSING_URL_HLP=e+"#"+Xmla.Exception.MISSING_URL_CDE+"_"+Xmla.Exception.MISSING_URL_MSG;Xmla.Exception.NO_EVENTS_SPECIFIED_CDE=-4;Xmla.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";Xmla.Exception.NO_EVENTS_SPECIFIED_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.WRONG_EVENTS_FORMAT_CDE=-5;Xmla.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";Xmla.Exception.WRONG_EVENTS_FORMAT_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.UNKNOWN_EVENT_CDE=-6;Xmla.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";Xmla.Exception.UNKNOWN_EVENT_HLP=e+"#"+Xmla.Exception.UNKNOWN_EVENT_CDE+"_"+Xmla.Exception.UNKNOWN_EVENT_MSG;Xmla.Exception.INVALID_EVENT_HANDLER_CDE=-7;Xmla.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";Xmla.Exception.INVALID_EVENT_HANDLER_HLP=e+"#"+Xmla.Exception.INVALID_EVENT_HANDLER_CDE+"_"+Xmla.Exception.INVALID_EVENT_HANDLER_MSG;Xmla.Exception.ERROR_PARSING_RESPONSE_CDE=-8;Xmla.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";Xmla.Exception.ERROR_PARSING_RESPONSE_HLP=e+"#"+Xmla.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+Xmla.Exception.ERROR_PARSING_RESPONSE_MSG;Xmla.Exception.INVALID_FIELD_CDE=-9;Xmla.Exception.INVALID_FIELD_MSG="Invalid_Field";Xmla.Exception.INVALID_FIELD_HLP=e+"#"+Xmla.Exception.INVALID_FIELD_CDE+"_"+Xmla.Exception.INVALID_FIELD_MSG;Xmla.Exception.HTTP_ERROR_CDE=-10;Xmla.Exception.HTTP_ERROR_MSG="HTTP Error";Xmla.Exception.HTTP_ERROR_HLP=e+"#"+Xmla.Exception.HTTP_ERROR_CDE+"_"+Xmla.Exception.HTTP_ERROR_MSG;Xmla.Exception._newError=function(G,I,H){return new Xmla.Exception(Xmla.Exception.TYPE_ERROR,Xmla.Exception[G+"_CDE"],Xmla.Exception[G+"_MSG"],Xmla.Exception[G+"_HLP"],I,H)};Xmla.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this}}}());