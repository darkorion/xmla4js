var Xmla;(function(){var D="http://schemas.xmlsoap.org/soap/",d=D+"envelope/",g="SOAP-ENV",k="xmlns:"+g+'="'+d+'"',u=g+':encodingStyle="'+D+'encoding/"',i="urn:schemas-microsoft-com:",w=i+"xml-analysis",h='xmlns="'+w+'"',I="sql",j=i+"xml-sql",E="http://www.w3.org/2001/XMLSchema",c="xsd",F="http://www.w3.org/2001/XMLSchema-instance",H="xsi",b=w+":rowset",v=w+":mddataset",a=window.ActiveXObject?true:false;function f(K){var M,J=false,L=function(){J=true;switch(M.readyState){case 0:K.aborted(M);break;case 4:if(M.status===200){K.complete(M)}else{K.error(Xmla.Exception._newError("HTTP_ERROR","_ajax",K))}break}};if(a){M=new ActiveXObject("MSXML2.XMLHTTP.3.0")}else{M=new XMLHttpRequest()}M.open("POST",K.url,K.async);M.onreadystatechange=L;M.setRequestHeader("Content-Type","text/xml");M.send(K.data);if(!K.async&&!J){L.call(M)}return M}function s(J){return typeof(J)==="undefined"}function G(J){return typeof(J)==="function"}function z(J){return typeof(J)==="string"}function B(J){return typeof(J)==="number"}function x(J){return typeof(J)==="object"}function p(J){return J.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var n=document.getElementsByTagNameNS?function(L,K,M,J){return L.getElementsByTagNameNS(K,J)}:function(L,K,M,J){if(M){return L.getElementsByTagName(M+":"+J)}else{return L.getElementsByTagName(J)}};var o=document.documentElement.getAttributeNS?function(K,L,M,J){return K.getAttributeNS(L,J)}:function(K,L,M,J){if(M){return K.getAttribute(M+":"+J)}else{return K.getAttribute(J)}};function t(J,P,N,L){if(!L){L=""}var O,M,Q,R,S,K="\n"+L+"<"+J+">";if(N){K+="\n"+L+" <"+P+">";for(R in N){if(N.hasOwnProperty(R)){S=N[R];K+="\n"+L+"  <"+R+">";if(typeof(S)==="array"){for(Q,M=0,O=S.length;M<O;M+=1){Q=S[M];K+="<Value>"+p(Q)+"</Value>"}}else{K+=p(S)}K+="</"+R+">"}}K+="\n"+L+" </"+P+">"}K+="\n"+L+"</"+J+">";return K}var m="RequestType";function C(J){var L="",M=J.method,K=null;L+="\n<"+g+":Envelope "+k+" "+u+">\n <"+g+":Body>\n  <"+M+" "+h+" "+u+">";switch(M){case Xmla.METHOD_DISCOVER:if(s(J.requestType)){K=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",J)}else{L+="\n   <"+m+">"+J.requestType+"</"+m+">"+t("Restrictions","RestrictionList",J.restrictions,"   ")+t("Properties","PropertyList",J.properties,"   ")}break;case Xmla.METHOD_EXECUTE:if(s(J.statement)){K=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",J)}else{L+="\n   <Command>\n    <Statement>"+J.statement+"</Statement>\n   </Command>"+t("Properties","PropertyList",J.properties,"   ")}break;default:}if(K!==null){K._throw()}L+="\n  </"+M+">\n </"+g+":Body>\n</"+g+":Envelope>";return L}function y(K,L,J){if(L&&(!K)){K={}}for(var M in L){if(L.hasOwnProperty(M)){if(J||s(K[M])){K[M]=L[M]}}}return K}Xmla=function(J){this.listeners={};this.listeners[Xmla.EVENT_REQUEST]=[];this.listeners[Xmla.EVENT_SUCCESS]=[];this.listeners[Xmla.EVENT_ERROR]=[];this.listeners[Xmla.EVENT_DISCOVER]=[];this.listeners[Xmla.EVENT_DISCOVER_SUCCESS]=[];this.listeners[Xmla.EVENT_DISCOVER_ERROR]=[];this.listeners[Xmla.EVENT_EXECUTE]=[];this.listeners[Xmla.EVENT_EXECUTE_SUCCESS]=[];this.listeners[Xmla.EVENT_EXECUTE_ERROR]=[];this.options=y(y({},Xmla.defaultOptions,true),J,true);return this};Xmla.defaultOptions={requestTimeout:30000,async:false};Xmla.METHOD_DISCOVER="Discover";Xmla.METHOD_EXECUTE="Execute";var q="DISCOVER_";var l="MDSCHEMA_";var r="DBSCHEMA_";Xmla.DISCOVER_DATASOURCES=q+"DATASOURCES";Xmla.DISCOVER_PROPERTIES=q+"PROPERTIES";Xmla.DISCOVER_SCHEMA_ROWSETS=q+"SCHEMA_ROWSETS";Xmla.DISCOVER_ENUMERATORS=q+"ENUMERATORS";Xmla.DISCOVER_KEYWORDS=q+"KEYWORDS";Xmla.DISCOVER_LITERALS=q+"LITERALS";Xmla.DBSCHEMA_CATALOGS=r+"CATALOGS";Xmla.DBSCHEMA_COLUMNS=r+"COLUMNS";Xmla.DBSCHEMA_PROVIDER_TYPES=r+"PROVIDER_TYPES";Xmla.DBSCHEMA_SCHEMATA=r+"SCHEMATA";Xmla.DBSCHEMA_TABLES=r+"TABLES";Xmla.DBSCHEMA_TABLES_INFO=r+"TABLES_INFO";Xmla.MDSCHEMA_ACTIONS=l+"ACTIONS";Xmla.MDSCHEMA_CUBES=l+"CUBES";Xmla.MDSCHEMA_DIMENSIONS=l+"DIMENSIONS";Xmla.MDSCHEMA_FUNCTIONS=l+"FUNCTIONS";Xmla.MDSCHEMA_HIERARCHIES=l+"HIERARCHIES";Xmla.MDSCHEMA_LEVELS=l+"LEVELS";Xmla.MDSCHEMA_MEASURES=l+"MEASURES";Xmla.MDSCHEMA_MEMBERS=l+"MEMBERS";Xmla.MDSCHEMA_PROPERTIES=l+"PROPERTIES";Xmla.MDSCHEMA_SETS=l+"SETS";Xmla.EVENT_REQUEST="request";Xmla.EVENT_SUCCESS="success";Xmla.EVENT_ERROR="error";Xmla.EVENT_EXECUTE="execute";Xmla.EVENT_EXECUTE_SUCCESS="executesuccess";Xmla.EVENT_EXECUTE_ERROR="executeerror";Xmla.EVENT_DISCOVER="discover";Xmla.EVENT_DISCOVER_SUCCESS="discoversuccess";Xmla.EVENT_DISCOVER_ERROR="discovererror";Xmla.EVENT_GENERAL=[Xmla.EVENT_REQUEST,Xmla.EVENT_SUCCESS,Xmla.EVENT_ERROR];Xmla.EVENT_DISCOVER_ALL=[Xmla.EVENT_DISCOVER,Xmla.EVENT_DISCOVER_SUCCESS,Xmla.EVENT_DISCOVER_ERROR];Xmla.EVENT_EXECUTE_ALL=[Xmla.EVENT_EXECUTE,Xmla.EVENT_EXECUTE_SUCCESS,Xmla.EVENT_EXECUTE_ERROR];Xmla.EVENT_ALL=[].concat(Xmla.EVENT_GENERAL,Xmla.EVENT_DISCOVER_ALL,Xmla.EVENT_EXECUTE_ALL);Xmla.PROP_DATASOURCEINFO="DataSourceInfo";Xmla.PROP_CATALOG="Catalog";Xmla.PROP_CUBE="Cube";Xmla.PROP_FORMAT="Format";Xmla.PROP_FORMAT_TABULAR="Tabular";Xmla.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";Xmla.PROP_AXISFORMAT="AxisFormat";Xmla.PROP_AXISFORMAT_TUPLE="TupleFormat";Xmla.PROP_AXISFORMAT_CLUSTER="ClusterFormat";Xmla.PROP_AXISFORMAT_CUSTOM="CustomFormat";Xmla.PROP_CONTENT="Content";Xmla.PROP_CONTENT_DATA="Data";Xmla.PROP_CONTENT_NONE="None";Xmla.PROP_CONTENT_SCHEMA="Schema";Xmla.PROP_CONTENT_SCHEMADATA="SchemaData";Xmla.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXml:null,setOptions:function(J){y(this.options,J,true)},addListener:function(O){var M=O.events;if(s(M)){Xmla.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",O)._throw()}if(z(M)){if(M==="all"){M=Xmla.EVENT_ALL}else{M=M.split(",")}}if(!(M instanceof Array)){Xmla.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",O)._throw()}var L=M.length;var J,N;for(var K=0;K<L;K+=1){J=M[K].replace(/\s+/g,"");N=this.listeners[J];if(!N){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",O)._throw()}if(G(O.handler)){if(!x(O.scope)){O.scope=window}N.push(O)}else{Xmla.Exception._newError("INVALID_EVENT_HANDLER","Xmla.addListener",O)._throw()}}},_fireEvent:function(O,R,K){var P=this.listeners[O];if(!P){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",O)._throw()}var N=P.length;var J=true;if(N){var L,Q;for(var M=0;M<N;M+=1){L=P[M];Q=L.handler.call(L.scope,O,R,this);if(K&&Q===false){J=false;break}}}else{if(O==="error"){R.exception._throw()}}return J},request:function(K){var M,L=this;if(this.response){this.response.close()}this.response=null;this.responseText=null;this.responseXml=null;K.url=s(K.url)?this.options.url:K.url;if(s(K.url)){M=Xmla.Exception._newError("MISSING_URL","Xmla.request",K);M._throw()}K.properties=y(K.properties,this.options.properties,false);K.restrictions=y(K.restrictions,this.options.restrictions,false);K.async=s(K.async)?this.options.async:K.async;K.requestTimeout=s(K.requestTimeout)?this.options.requestTimeout:K.requestTimeout;var N=C(K);this.soapMessage=N;var O;var J={async:K.async,timeout:K.requestTimeout,data:N,error:function(P){K.exception=P;L._requestError(K)},complete:function(P){K.xhr=P;L._requestSuccess(K)},url:K.url};if(K.username){J.username=K.username}if(K.password){J.password=K.password}if(this._fireEvent(Xmla.EVENT_REQUEST,K,true)&&((K.method==Xmla.METHOD_DISCOVER&&this._fireEvent(Xmla.EVENT_DISCOVER,K))||(K.method==Xmla.METHOD_EXECUTE&&this._fireEvent(Xmla.EVENT_EXECUTE,K)))){O=f(J)}return this.response},_requestError:function(J){this._fireEvent("error",J)},_requestSuccess:function(K){var O=K.xhr;this.responseXML=O.responseXML;this.responseText=O.responseText;var P=K.method;var J=n(this.responseXML,d,g,"Fault");if(J.length){J=J.item(0);K.exception=new Xmla.Exception(Xmla.Exception.TYPE_ERROR,J.getElementsByTagName("faultcode").item(0).childNodes.item(0).data,J.getElementsByTagName("faultstring").item(0).childNodes.item(0).data,null,"_requestSuccess",K);switch(P){case Xmla.METHOD_DISCOVER:this._fireEvent(Xmla.EVENT_DISCOVER_ERROR,K);break;case Xmla.METHOD_EXECUTE:this._fireEvent(Xmla.EVENT_EXECUTE_ERROR,K);break}this._fireEvent(Xmla.EVENT_ERROR,K)}else{switch(P){case Xmla.METHOD_DISCOVER:var N=new Xmla.Rowset(this.responseXML,K.requestType);K.rowset=N;this.response=N;this._fireEvent(Xmla.EVENT_DISCOVER_SUCCESS,K);break;case Xmla.METHOD_EXECUTE:var M;var L=K.properties[Xmla.PROP_FORMAT];switch(L){case Xmla.PROP_FORMAT_TABULAR:M=new Xmla.Rowset(this.responseXML);break;case Xmla.PROP_FORMAT_MULTIDIMENSIONAL:break}K.resultset=M;this.response=M;this._fireEvent(Xmla.EVENT_EXECUTE_SUCCESS,K);break}this._fireEvent(Xmla.EVENT_SUCCESS,K)}},execute:function(J){var K=J.properties;if(s(K)){K={};J.properties=K}if(s(K[Xmla.PROP_CONTENT])){K[Xmla.PROP_CONTENT]=Xmla.PROP_CONTENT_SCHEMADATA}if(s(K[Xmla.PROP_FORMAT])){J.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL}var L=y(J,{method:Xmla.METHOD_EXECUTE},true);return this.request(L)},executeTabular:function(J){if(!J.properties){J.properties={}}J.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_TABULAR;return this.execute(J)},executeMultiDimensional:function(J){if(!J.properties){J.properties={}}J.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(J)},discover:function(J){var K=y(J,{method:Xmla.METHOD_DISCOVER},true);return this.request(K)},discoverDataSources:function(J){var K=y(J,{requestType:Xmla.DISCOVER_DATASOURCES},true);return this.discover(K)},discoverProperties:function(J){var K=y(J,{requestType:Xmla.DISCOVER_PROPERTIES},true);return this.discover(K)},discoverSchemaRowsets:function(J){var K=y(J,{requestType:Xmla.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(K)},discoverEnumerators:function(J){var K=y(J,{requestType:Xmla.DISCOVER_ENUMERATORS},true);return this.discover(K)},discoverKeywords:function(J){var K=y(J,{requestType:Xmla.DISCOVER_KEYWORDS},true);return this.discover(K)},discoverLiterals:function(J){var K=y(J,{requestType:Xmla.DISCOVER_LITERALS},true);return this.discover(K)},discoverDBCatalogs:function(J){var K=y(J,{requestType:Xmla.DBSCHEMA_CATALOGS},true);return this.discover(K)},discoverDBColumns:function(J){var K=y(J,{requestType:Xmla.DBSCHEMA_COLUMNS},true);return this.discover(K)},discoverDBProviderTypes:function(J){var K=y(J,{requestType:Xmla.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(K)},discoverDBSchemata:function(J){var K=y(J,{requestType:Xmla.DBSCHEMA_SCHEMATA},true);return this.discover(K)},discoverDBTables:function(J){var K=y(J,{requestType:Xmla.DBSCHEMA_TABLES},true);return this.discover(K)},discoverDBTablesInfo:function(J){var K=y(J,{requestType:Xmla.DBSCHEMA_TABLES_INFO},true);return this.discover(K)},discoverMDActions:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_ACTIONS},true);return this.discover(K)},discoverMDCubes:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_CUBES},true);return this.discover(K)},discoverMDDimensions:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_DIMENSIONS},true);return this.discover(K)},discoverMDFunctions:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_FUNCTIONS},true);return this.discover(K)},discoverMDHierarchies:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_HIERARCHIES},true);return this.discover(K)},discoverMDLevels:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_LEVELS},true);return this.discover(K)},discoverMDMeasures:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_MEASURES},true);return this.discover(K)},discoverMDMembers:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_MEMBERS},true);return this.discover(K)},discoverMDProperties:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_PROPERTIES},true);return this.discover(K)},discoverMDSets:function(J){var K=y(J,{requestType:Xmla.MDSCHEMA_SETS},true);return this.discover(K)}};function A(N){var K=n(N,E,c,"complexType"),M=K.length,L,J;for(J=0;J<M;J+=1){L=K.item(J);if(L.getAttribute("name")==="row"){return L}}return null}Xmla.Rowset=function(K,J){this._initData(K,J);return this};Xmla.Rowset.MD_DIMTYPE_UNKNOWN=0;Xmla.Rowset.MD_DIMTYPE_TIME=1;Xmla.Rowset.MD_DIMTYPE_MEASURE=2;Xmla.Rowset.MD_DIMTYPE_OTHER=3;Xmla.Rowset.MD_DIMTYPE_QUANTITATIVE=5;Xmla.Rowset.MD_DIMTYPE_ACCOUNTS=6;Xmla.Rowset.MD_DIMTYPE_CUSTOMERS=7;Xmla.Rowset.MD_DIMTYPE_PRODUCTS=8;Xmla.Rowset.MD_DIMTYPE_SCENARIO=9;Xmla.Rowset.MD_DIMTYPE_UTILIY=10;Xmla.Rowset.MD_DIMTYPE_CURRENCY=11;Xmla.Rowset.MD_DIMTYPE_RATES=12;Xmla.Rowset.MD_DIMTYPE_CHANNEL=13;Xmla.Rowset.MD_DIMTYPE_PROMOTION=14;Xmla.Rowset.MD_DIMTYPE_ORGANIZATION=15;Xmla.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;Xmla.Rowset.MD_DIMTYPE_GEOGRAPHY=17;Xmla.Rowset.KEYS={};Xmla.Rowset.KEYS[Xmla.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_COLUMNS]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_PROVIDER_TYPES]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_SCHEMATA]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES_INFO]=[];Xmla.Rowset.KEYS[Xmla.DISCOVER_DATASOURCES]=["DataSourceName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_KEYWORDS]=["Keyword"];Xmla.Rowset.KEYS[Xmla.DISCOVER_LITERALS]=["LiteralName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_PROPERTIES]=["PropertyName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_SCHEMA_ROWSETS]=["SchemaName"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_ACTIONS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_CUBES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_FUNCTIONS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","HIERARCHY_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_LEVELS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEASURES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","MEASURE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEMBERS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_PROPERTIES]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_SETS]=[];Xmla.Rowset.prototype={_type:null,rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(M,S){this._type=S;this.rows=n(M,b,null,"row");this.numRows=this.rows?this.rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var R=A(M);if(R){var X=n(R,E,c,"sequence").item(0),O=X.childNodes,Q=O.length,V,J,W,T,N,U,K;for(var P=0;P<Q;P+=1){V=O.item(P);if(V.nodeType!==1){continue}J=o(V,j,I,"field");W=V.getAttribute("name");U=V.getAttribute("type");if(U===null&&this.row){var L=this.row.getElementsByTagName(W);if(L.length){U=o(L.item(0),F,H,"type")}}if(!U&&S==Xmla.DISCOVER_SCHEMA_ROWSETS&&W==="Restrictions"){U="Restrictions"}T=V.getAttribute("minOccurs");N=V.getAttribute("maxOccurs");K=this._getValueConverter(U);this.fields[J]={name:W,label:J,index:this._fieldCount+=1,type:U,jsType:K.jsType,minOccurs:s(T)?1:T,maxOccurs:s(N)?1:(N==="unbounded"?Infinity:N),getter:this._createFieldGetter(W,K.func,T,N)};this.fieldOrder.push(J)}}else{Xmla.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",M)._throw()}},_boolConverter:function(J){return J==="true"?true:false},_intConverter:function(J){return parseInt(J,10)},_floatConverter:function(J){return parseFloat(J,10)},_textConverter:function(J){return J},_restrictionsConverter:function(J){return J},_arrayConverter:function(L,K){var J=[],N=L.length,O;for(var M=0;M<N;M+=1){O=L.item(M);J.push(K(this._elementText(O)))}return J},_elementText:function(K){if(K.innerText){return K.innerText}else{if(K.textContent){return K.textContent}else{var N="",M=K.childNodes,L=M.length;for(var J=0;J<L;J+=1){N+=M.item(J).data}return N}}},_getValueConverter:function(K){var J={};switch(K){case"xsd:boolean":J.func=this._boolConverter;J.jsType="boolean";break;case"xsd:decimal":case"xsd:double":case"xsd:float":J.func=this._floatConverter;J.jsType="number";break;case"xsd:int":case"xsd:integer":case"xsd:nonPositiveInteger":case"xsd:negativeInteger":case"xsd:nonNegativeInteger":case"xsd:positiveInteger":case"xsd:short":case"xsd:byte":case"xsd:long":case"xsd:unsignedLong":case"xsd:unsignedInt":case"xsd:unsignedShort":case"xsd:unsignedByte":J.func=this._intConverter;J.jsType="number";break;case"xsd:string":J.func=this._textConverter;J.jsType="string";break;case"Restrictions":J.func=this._restrictionsConverter;J.jsType="object";break;default:J.func=this._textConverter;J.jsType="object";break}return J},_createFieldGetter:function(O,K,N,L){if(N===null){N="1"}if(L===null){L="1"}var M=this;var J;if(L==="1"){if(N==="1"){J=function(){var P=n(this.row,b,null,O);return K(M._elementText(P.item(0)))}}else{if(N==="0"){J=function(){var P=n(this.row,b,null,O);if(!P.length){return null}else{return K(M._elementText(P.item(0)))}}}}}else{if(N==="1"){J=function(){var P=n(this.row,b,null,O);return M._arrayConverter(P,K)}}else{if(N==="0"){J=function(){var P=n(this.row,b,null,O);if(!P.length){return null}else{return M._arrayConverter(P,K)}}}}}return J},getType:function(){return this._type},getFields:function(){var M=[],L=this._fieldCount,J=this.fieldOrder;for(var K=0;K<L;K+=1){M[K]=this.fieldDef(J[K])}return M},getFieldNames:function(){var L=[];for(var J=0,K=this.fieldCount();J<K;J+=1){L[J]=this.fieldOrder[J]}return L},hasMoreRows:function(){return this.numRows>this.rowIndex},next:function(){this.rowIndex+=1;this.row=this.rows.item(this.rowIndex)},curr:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this.row=(this.hasMoreRows())?this.rows.item(this.rowIndex):null},fieldDef:function(J){var K=this.fields[J];if(s(K)){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",J)._throw()}return K},fieldIndex:function(J){var K=this.fieldDef(J);return K.index},fieldName:function(J){var K=this.fieldOrder[J];if(s(K)){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",J)._throw()}return K},fieldVal:function(J){if(B(J)){J=this.fieldName(J)}var K=this.fieldDef(J);return K.getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this.row=null;this.rows=null},readAsArray:function(){var M=[],J=this.fields,L,K;for(L in J){if(J.hasOwnProperty(L)){K=J[L];M[K.index]=K.getter.call(this)}}return M},fetchAsArray:function(){var J;if(this.hasMoreRows()){J=this.readAsArray();this.next()}else{J=false}return J},readAsObject:function(){var K={},J=this.fields,M,L;for(M in J){if(J.hasOwnProperty(M)){L=J[M];K[M]=L.getter.call(this)}}return K},fetchAsObject:function(){var J;if(this.hasMoreRows()){J=this.readAsObject();this.next()}else{J=false}return J},fetchCustom:function(K){var J;if(this.hasMoreRows()){J=K.call(this);this.next()}else{J=false}return J},fetchAllAsArray:function(J){var K;if(!J){J=[]}while((K=this.fetchAsArray())){J.push(K)}return J},fetchAllAsObject:function(J){var K;if(!J){J=[]}while((K=this.fetchAsObject())){J.push(K)}return J},fetchAllCustom:function(K,J){var L;if(!K){K=[]}while((L=this.fetchCustom(J))){K.push(L)}return K},mapAsObject:function(J,Q,S){var M,R,K,N,O=Q.length,P=O-1,L=J;for(N=0;N<O;N+=1){M=Q[N];R=S[M];K=L[R];if(K){if(N===P){if(K instanceof Array){K.push(S)}else{L[R]=[K,S]}}else{L=K}}else{if(N===P){L[R]=S}else{L=L[R]={}}}}},mapAllAsObject:function(J,K){if(!K){K={}}if(!J){J=this.getKey()}var L;while(L=this.fetchAsObject()){this.mapAsObject(K,J,L)}return K},getKey:function(){var J;if(this._type){J=Xmla.Rowset.KEYS[this._type]}else{J=this.getFieldNames()}return J}};Xmla.Exception=function(K,M,L,J,O,N){this.type=K;this.code=M;this.message=L;this.source=O;this.helpfile=J;this.data=N;return this};Xmla.Exception.TYPE_WARNING="warning";Xmla.Exception.TYPE_ERROR="error";var e="http://code.google.com/p/xmla4js/wiki/ExceptionCodes";Xmla.Exception.MISSING_REQUEST_TYPE_CDE=-1;Xmla.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";Xmla.Exception.MISSING_REQUEST_TYPE_HLP=e+"#"+Xmla.Exception.MISSING_REQUEST_TYPE_CDE+"_"+Xmla.Exception.MISSING_REQUEST_TYPE_MSG;Xmla.Exception.MISSING_STATEMENT_CDE=-2;Xmla.Exception.MISSING_STATEMENT_MSG="Missing_Statement";Xmla.Exception.MISSING_STATEMENT_HLP=e+"#"+Xmla.Exception.MISSING_STATEMENT_CDE+"_"+Xmla.Exception.MISSING_STATEMENT_MSG;Xmla.Exception.MISSING_URL_CDE=-3;Xmla.Exception.MISSING_URL_MSG="Missing_URL";Xmla.Exception.MISSING_URL_HLP=e+"#"+Xmla.Exception.MISSING_URL_CDE+"_"+Xmla.Exception.MISSING_URL_MSG;Xmla.Exception.NO_EVENTS_SPECIFIED_CDE=-4;Xmla.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";Xmla.Exception.NO_EVENTS_SPECIFIED_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.WRONG_EVENTS_FORMAT_CDE=-5;Xmla.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";Xmla.Exception.WRONG_EVENTS_FORMAT_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.UNKNOWN_EVENT_CDE=-6;Xmla.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";Xmla.Exception.UNKNOWN_EVENT_HLP=e+"#"+Xmla.Exception.UNKNOWN_EVENT_CDE+"_"+Xmla.Exception.UNKNOWN_EVENT_MSG;Xmla.Exception.INVALID_EVENT_HANDLER_CDE=-7;Xmla.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";Xmla.Exception.INVALID_EVENT_HANDLER_HLP=e+"#"+Xmla.Exception.INVALID_EVENT_HANDLER_CDE+"_"+Xmla.Exception.INVALID_EVENT_HANDLER_MSG;Xmla.Exception.ERROR_PARSING_RESPONSE_CDE=-8;Xmla.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";Xmla.Exception.ERROR_PARSING_RESPONSE_HLP=e+"#"+Xmla.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+Xmla.Exception.ERROR_PARSING_RESPONSE_MSG;Xmla.Exception.INVALID_FIELD_CDE=-9;Xmla.Exception.INVALID_FIELD_MSG="Invalid_Field";Xmla.Exception.INVALID_FIELD_HLP=e+"#"+Xmla.Exception.INVALID_FIELD_CDE+"_"+Xmla.Exception.INVALID_FIELD_MSG;Xmla.Exception.HTTP_ERROR_CDE=-10;Xmla.Exception.HTTP_ERROR_MSG="HTTP Error";Xmla.Exception.HTTP_ERROR_HLP=e+"#"+Xmla.Exception.INVALID_FIELD_CDE+"_"+Xmla.Exception.INVALID_FIELD_MSG;Xmla.Exception._newError=function(J,L,K){return new Xmla.Exception(Xmla.Exception.TYPE_ERROR,Xmla.Exception[J+"_CDE"],Xmla.Exception[J+"_MSG"],Xmla.Exception[J+"_HLP"],L,K)};Xmla.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this}}}());