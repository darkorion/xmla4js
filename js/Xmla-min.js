(function(){var C="http://schemas.xmlsoap.org/soap/",d=C+"envelope/",g="SOAP-ENV",k="xmlns:"+g+'="'+d+'"',u=g+':encodingStyle="'+C+'encoding/"',i="urn:schemas-microsoft-com:",v=i+"xml-analysis",h='xmlns="'+v+'"',H="sql",j=i+"xml-sql",D="http://www.w3.org/2001/XMLSchema",c="xsd",E="http://www.w3.org/2001/XMLSchema-instance",G="xsi",b=v+":rowset",a=window.ActiveXObject?true:false;function f(J){var L;if(a){L=new ActiveXObject("MSXML2.XMLHTTP.3.0")}else{L=new XMLHttpRequest()}L.open("POST",J.url,J.async);var I=false;var K=function(){I=true;switch(L.readyState){case 0:J.aborted(L);break;case 4:if(L.status===200){J.complete(L)}else{J.error(Xmla.Exception._newError("HTTP_ERROR","_ajax",J))}break}};L.onreadystatechange=K;L.setRequestHeader("Content-Type","text/xml");L.send(J.data);if(!J.async&&!I){K.call(L)}return L}function s(I){return typeof(I)==="undefined"}function F(I){return typeof(I)==="function"}function y(I){return typeof(I)==="string"}function A(I){return typeof(I)==="number"}function w(I){return typeof(I)==="object"}function p(I){return I.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var n=function(K,J,L,I){if(F(K.getElementsByTagNameNS)){return K.getElementsByTagNameNS(J,I)}else{if(L){return K.getElementsByTagName(L+":"+I)}else{return K.getElementsByTagName(I)}}};var o=function(J,K,L,I){if(F(J.getAttributeNS)){return J.getAttributeNS(K,I)}else{if(L){return J.getAttribute(L+":"+I)}else{return J.getAttribute(I)}}};function t(I,O,M,K){if(!K){K=""}var J="\n"+K+"<"+I+">";if(M){var R;J+="\n"+K+" <"+O+">";for(var Q in M){if(M.hasOwnProperty(Q)){R=M[Q];J+="\n"+K+"  <"+Q+">";if(typeof(R)==="array"){for(var P,L=0,N=R.length;L<N;L++){P=R[L];J+="<Value>"+p(P)+"</Value>"}}else{J+=p(R)}J+="</"+Q+">"}}J+="\n"+K+" </"+O+">"}J+="\n"+K+"</"+I+">";return J}var m="RequestType";function B(I){var K="";var L=I.method;K+="\n<"+g+":Envelope "+k+" "+u+">\n <"+g+":Body>\n  <"+L+" "+h+" "+u+">";var J=null;switch(L){case Xmla.METHOD_DISCOVER:if(s(I.requestType)){J=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",I)}else{K+="\n   <"+m+">"+I.requestType+"</"+m+">"+t("Restrictions","RestrictionList",I.restrictions,"   ")+t("Properties","PropertyList",I.properties,"   ")}break;case Xmla.METHOD_EXECUTE:if(s(I.statement)){J=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",I)}else{K+="\n   <Command>\n    <Statement>"+I.statement+"</Statement>\n   </Command>"+t("Properties","PropertyList",I.properties,"   ")}break;default:}if(J!==null){J._throw()}K+="\n  </"+L+">\n </"+g+":Body>\n</"+g+":Envelope>";return K}function x(J,K,I){if(K&&(!J)){J={}}for(var L in K){if(K.hasOwnProperty(L)){if(I||s(J[L])){J[L]=K[L]}}}return J}Xmla=function(I){this.listeners={};this.listeners[Xmla.EVENT_REQUEST]=[];this.listeners[Xmla.EVENT_SUCCESS]=[];this.listeners[Xmla.EVENT_ERROR]=[];this.listeners[Xmla.EVENT_DISCOVER]=[];this.listeners[Xmla.EVENT_DISCOVER_SUCCESS]=[];this.listeners[Xmla.EVENT_DISCOVER_ERROR]=[];this.listeners[Xmla.EVENT_EXECUTE]=[];this.listeners[Xmla.EVENT_EXECUTE_SUCCESS]=[];this.listeners[Xmla.EVENT_EXECUTE_ERROR]=[];this.options=x(x({},Xmla.defaultOptions,true),I,true);return this};Xmla.defaultOptions={requestTimeout:30000,async:false};Xmla.METHOD_DISCOVER="Discover";Xmla.METHOD_EXECUTE="Execute";var q="DISCOVER_";var l="MDSCHEMA_";var r="DBSCHEMA_";Xmla.DISCOVER_DATASOURCES=q+"DATASOURCES";Xmla.DISCOVER_PROPERTIES=q+"PROPERTIES";Xmla.DISCOVER_SCHEMA_ROWSETS=q+"SCHEMA_ROWSETS";Xmla.DISCOVER_ENUMERATORS=q+"ENUMERATORS";Xmla.DISCOVER_KEYWORDS=q+"KEYWORDS";Xmla.DISCOVER_LITERALS=q+"LITERALS";Xmla.DBSCHEMA_CATALOGS=r+"CATALOGS";Xmla.DBSCHEMA_COLUMNS=r+"COLUMNS";Xmla.DBSCHEMA_PROVIDER_TYPES=r+"PROVIDER_TYPES";Xmla.DBSCHEMA_SCHEMATA=r+"SCHEMATA";Xmla.DBSCHEMA_TABLES=r+"TABLES";Xmla.DBSCHEMA_TABLES_INFO=r+"TABLES_INFO";Xmla.MDSCHEMA_ACTIONS=l+"ACTIONS";Xmla.MDSCHEMA_CUBES=l+"CUBES";Xmla.MDSCHEMA_DIMENSIONS=l+"DIMENSIONS";Xmla.MDSCHEMA_FUNCTIONS=l+"FUNCTIONS";Xmla.MDSCHEMA_HIERARCHIES=l+"HIERARCHIES";Xmla.MDSCHEMA_LEVELS=l+"LEVELS";Xmla.MDSCHEMA_MEASURES=l+"MEASURES";Xmla.MDSCHEMA_MEMBERS=l+"MEMBERS";Xmla.MDSCHEMA_PROPERTIES=l+"PROPERTIES";Xmla.MDSCHEMA_SETS=l+"SETS";Xmla.EVENT_REQUEST="request";Xmla.EVENT_SUCCESS="success";Xmla.EVENT_ERROR="error";Xmla.EVENT_EXECUTE="execute";Xmla.EVENT_EXECUTE_SUCCESS="executesuccess";Xmla.EVENT_EXECUTE_ERROR="executeerror";Xmla.EVENT_DISCOVER="discover";Xmla.EVENT_DISCOVER_SUCCESS="discoversuccess";Xmla.EVENT_DISCOVER_ERROR="discovererror";Xmla.EVENT_GENERAL=[Xmla.EVENT_REQUEST,Xmla.EVENT_SUCCESS,Xmla.EVENT_ERROR];Xmla.EVENT_DISCOVER_ALL=[Xmla.EVENT_DISCOVER,Xmla.EVENT_DISCOVER_SUCCESS,Xmla.EVENT_DISCOVER_ERROR];Xmla.EVENT_EXECUTE_ALL=[Xmla.EVENT_EXECUTE,Xmla.EVENT_EXECUTE_SUCCESS,Xmla.EVENT_EXECUTE_ERROR];Xmla.EVENT_ALL=[].concat(Xmla.EVENT_GENERAL,Xmla.EVENT_DISCOVER_ALL,Xmla.EVENT_EXECUTE_ALL);Xmla.PROP_DATASOURCEINFO="DataSourceInfo";Xmla.PROP_CATALOG="Catalog";Xmla.PROP_CUBE="Cube";Xmla.PROP_FORMAT="Format";Xmla.PROP_FORMAT_TABULAR="Tabular";Xmla.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";Xmla.PROP_AXISFORMAT="AxisFormat";Xmla.PROP_AXISFORMAT_TUPLE="TupleFormat";Xmla.PROP_AXISFORMAT_CLUSTER="ClusterFormat";Xmla.PROP_AXISFORMAT_CUSTOM="CustomFormat";Xmla.PROP_CONTENT="Content";Xmla.PROP_CONTENT_DATA="Data";Xmla.PROP_CONTENT_NONE="None";Xmla.PROP_CONTENT_SCHEMA="Schema";Xmla.PROP_CONTENT_SCHEMADATA="SchemaData";Xmla.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXml:null,setOptions:function(I){x(this.options,I,true)},addListener:function(N){var L=N.events;if(s(L)){Xmla.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",N)._throw()}if(y(L)){if(L==="all"){L=Xmla.EVENT_ALL}else{L=L.split(",")}}if(!(L instanceof Array)){Xmla.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",N)._throw()}var K=L.length;var I,M;for(var J=0;J<K;J++){I=L[J].replace(/\s+/g,"");M=this.listeners[I];if(!M){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",N)._throw()}if(F(N.handler)){if(!w(N.scope)){N.scope=window}M.push(N)}else{Xmla.Exception._newError("INVALID_EVENT_HANDLER","Xmla.addListener",N)._throw()}}},_fireEvent:function(N,Q,J){var O=this.listeners[N];if(!O){Xmla.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",N)._throw()}var M=O.length;var I=true;if(M){var K,P;for(var L=0;L<M;L++){K=O[L];P=K.handler.call(K.scope,N,Q,this);if(J&&P===false){I=false;break}}}else{if(N==="error"){Q.exception._throw()}}return I},request:function(J){var K=this;if(this.response){this.response.close()}this.response=null;this.responseText=null;this.responseXml=null;J.url=s(J.url)?this.options.url:J.url;if(s(J.url)){ex=Xmla.Exception._newError("MISSING_URL","Xmla.request",J);ex._throw()}J.properties=x(J.properties,this.options.properties,false);J.restrictions=x(J.restrictions,this.options.restrictions,false);J.async=s(J.async)?this.options.async:J.async;J.requestTimeout=s(J.requestTimeout)?this.options.requestTimeout:J.requestTimeout;var L=B(J);this.soapMessage=L;var M;var I={async:J.async,timeout:J.requestTimeout,data:L,error:function(N){J.exception=exeception;K._requestError(J)},complete:function(N){J.xhr=N;K._requestSuccess(J)},url:J.url};if(J.username){I.username=J.username}if(J.password){I.password=J.password}if(this._fireEvent(Xmla.EVENT_REQUEST,J,true)&&((J.method==Xmla.METHOD_DISCOVER&&this._fireEvent(Xmla.EVENT_DISCOVER,J))||(J.method==Xmla.METHOD_EXECUTE&&this._fireEvent(Xmla.EVENT_EXECUTE,J)))){M=f(I)}return this.response},_requestError:function(I){this._fireEvent("error",I)},_requestSuccess:function(J){var N=J.xhr;this.responseXML=N.responseXML;this.responseText=N.responseText;var O=J.method;var I=n(this.responseXML,d,g,"Fault");if(I.length){I=I.item(0);J.exception=new Xmla.Exception(Xmla.Exception.TYPE_ERROR,I.getElementsByTagName("faultcode").item(0).childNodes.item(0).data,I.getElementsByTagName("faultstring").item(0).childNodes.item(0).data,null,"_requestSuccess",J);switch(O){case Xmla.METHOD_DISCOVER:this._fireEvent(Xmla.EVENT_DISCOVER_ERROR,J);break;case Xmla.METHOD_EXECUTE:this._fireEvent(Xmla.EVENT_EXECUTE_ERROR,J);break}this._fireEvent(Xmla.EVENT_ERROR,J)}else{switch(O){case Xmla.METHOD_DISCOVER:var M=new Xmla.Rowset(this.responseXML,J.requestType);J.rowset=M;this.response=M;this._fireEvent(Xmla.EVENT_DISCOVER_SUCCESS,J);break;case Xmla.METHOD_EXECUTE:var L;var K=J.properties[Xmla.PROP_FORMAT];switch(K){case Xmla.PROP_FORMAT_TABULAR:L=new Xmla.Rowset(this.responseXML);break;case Xmla.PROP_FORMAT_MULTIDIMENSIONAL:break}J.resultset=L;this.response=L;this._fireEvent(Xmla.EVENT_EXECUTE_SUCCESS,J);break}this._fireEvent(Xmla.EVENT_SUCCESS,J)}},execute:function(I){var J=I.properties;if(s(J)){J={};I.properties=J}if(s(J[Xmla.PROP_CONTENT])){J[Xmla.PROP_CONTENT]=Xmla.PROP_CONTENT_SCHEMADATA}if(s(J[Xmla.PROP_FORMAT])){I.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL}var K=x(I,{method:Xmla.METHOD_EXECUTE},true);return this.request(K)},executeTabular:function(I){if(!I.properties){I.properties={}}I.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_TABULAR;return this.execute(I)},executeMultiDimensional:function(I){if(!I.properties){I.properties={}}I.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(I)},discover:function(I){var J=x(I,{method:Xmla.METHOD_DISCOVER},true);return this.request(J)},discoverDataSources:function(I){var J=x(I,{requestType:Xmla.DISCOVER_DATASOURCES},true);return this.discover(J)},discoverProperties:function(I){var J=x(I,{requestType:Xmla.DISCOVER_PROPERTIES},true);return this.discover(J)},discoverSchemaRowsets:function(I){var J=x(I,{requestType:Xmla.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(J)},discoverEnumerators:function(I){var J=x(I,{requestType:Xmla.DISCOVER_ENUMERATORS},true);return this.discover(J)},discoverKeywords:function(I){var J=x(I,{requestType:Xmla.DISCOVER_KEYWORDS},true);return this.discover(J)},discoverLiterals:function(I){var J=x(I,{requestType:Xmla.DISCOVER_LITERALS},true);return this.discover(J)},discoverDBCatalogs:function(I){var J=x(I,{requestType:Xmla.DBSCHEMA_CATALOGS},true);return this.discover(J)},discoverDBColumns:function(I){var J=x(I,{requestType:Xmla.DBSCHEMA_COLUMNS},true);return this.discover(J)},discoverDBProviderTypes:function(I){var J=x(I,{requestType:Xmla.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(J)},discoverDBSchemata:function(I){var J=x(I,{requestType:Xmla.DBSCHEMA_SCHEMATA},true);return this.discover(J)},discoverDBTables:function(I){var J=x(I,{requestType:Xmla.DBSCHEMA_TABLES},true);return this.discover(J)},discoverDBTablesInfo:function(I){var J=x(I,{requestType:Xmla.DBSCHEMA_TABLES_INFO},true);return this.discover(J)},discoverMDActions:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_ACTIONS},true);return this.discover(J)},discoverMDCubes:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_CUBES},true);return this.discover(J)},discoverMDDimensions:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_DIMENSIONS},true);return this.discover(J)},discoverMDFunctions:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_FUNCTIONS},true);return this.discover(J)},discoverMDHierarchies:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_HIERARCHIES},true);return this.discover(J)},discoverMDLevels:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_LEVELS},true);return this.discover(J)},discoverMDMeasures:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_MEASURES},true);return this.discover(J)},discoverMDMembers:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_MEMBERS},true);return this.discover(J)},discoverMDProperties:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_PROPERTIES},true);return this.discover(J)},discoverMDSets:function(I){var J=x(I,{requestType:Xmla.MDSCHEMA_SETS},true);return this.discover(J)}};function z(M){var J=n(M,D,c,"complexType"),L=J.length,K,I;for(I=0;I<L;I++){K=J.item(I);if(K.getAttribute("name")==="row"){return K}}return null}Xmla.Rowset=function(J,I){this._initData(J,I);return this};Xmla.Rowset.MD_DIMTYPE_UNKNOWN=0;Xmla.Rowset.MD_DIMTYPE_TIME=1;Xmla.Rowset.MD_DIMTYPE_MEASURE=2;Xmla.Rowset.MD_DIMTYPE_OTHER=3;Xmla.Rowset.MD_DIMTYPE_QUANTITATIVE=5;Xmla.Rowset.MD_DIMTYPE_ACCOUNTS=6;Xmla.Rowset.MD_DIMTYPE_CUSTOMERS=7;Xmla.Rowset.MD_DIMTYPE_PRODUCTS=8;Xmla.Rowset.MD_DIMTYPE_SCENARIO=9;Xmla.Rowset.MD_DIMTYPE_UTILIY=10;Xmla.Rowset.MD_DIMTYPE_CURRENCY=11;Xmla.Rowset.MD_DIMTYPE_RATES=12;Xmla.Rowset.MD_DIMTYPE_CHANNEL=13;Xmla.Rowset.MD_DIMTYPE_PROMOTION=14;Xmla.Rowset.MD_DIMTYPE_ORGANIZATION=15;Xmla.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;Xmla.Rowset.MD_DIMTYPE_GEOGRAPHY=17;Xmla.Rowset.KEYS={};Xmla.Rowset.KEYS[Xmla.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_COLUMNS]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_PROVIDER_TYPES]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_SCHEMATA]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES]=[];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES_INFO]=[];Xmla.Rowset.KEYS[Xmla.DISCOVER_DATASOURCES]=["DataSourceName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_KEYWORDS]=["Keyword"];Xmla.Rowset.KEYS[Xmla.DISCOVER_LITERALS]=["LiteralName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_PROPERTIES]=["PropertyName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_SCHEMA_ROWSETS]=["SchemaName"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_ACTIONS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_CUBES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_FUNCTIONS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","HIERARCHY_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_LEVELS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEASURES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","MEASURE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEMBERS]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_PROPERTIES]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_SETS]=[];Xmla.Rowset.prototype={_type:null,rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(L,R){this._type=R;this.rows=n(L,b,null,"row");this.numRows=this.rows?this.rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var Q=z(L);if(Q){var W=n(Q,D,c,"sequence").item(0),N=W.childNodes,P=N.length,U,I,V,S,M,T,J;for(var O=0;O<P;O++){U=N.item(O);if(U.nodeType!=1){continue}I=o(U,j,H,"field");V=U.getAttribute("name");T=U.getAttribute("type");if(T==null&&this.row){var K=this.row.getElementsByTagName(V);if(K.length){T=o(K.item(0),E,G,"type")}}if(!T&&R==Xmla.DISCOVER_SCHEMA_ROWSETS&&V=="Restrictions"){T="Restrictions"}S=U.getAttribute("minOccurs");M=U.getAttribute("maxOccurs");J=this._getValueConverter(T);this.fields[I]={name:V,label:I,index:this._fieldCount++,type:T,jsType:J.jsType,minOccurs:s(S)?1:S,maxOccurs:s(M)?1:(M==="unbounded"?Infinity:M),getter:this._createFieldGetter(V,J.func,S,M)};this.fieldOrder.push(I)}}else{Xmla.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",L)._throw()}},_boolConverter:function(I){return I==="true"?true:false},_intConverter:function(I){return parseInt(I,10)},_floatConverter:function(I){return parseFloat(I,10)},_textConverter:function(I){return I},_restrictionsConverter:function(I){return I},_arrayConverter:function(K,J){var I=[],M=K.length,N;for(var L=0;L<M;L++){N=K.item(L);I.push(J(this._elementText(N)))}return I},_elementText:function(J){if(J.innerText){return J.innerText}else{if(J.textContent){return J.textContent}else{var M="",L=J.childNodes,K=L.length;for(var I=0;I<K;I++){M+=L.item(I).data}return M}}},_getValueConverter:function(J){var I={};switch(J){case"xsd:boolean":I.func=this._boolConverter;I.jsType="boolean";break;case"xsd:decimal":case"xsd:double":case"xsd:float":I.func=this._floatConverter;I.jsType="number";break;case"xsd:int":case"xsd:integer":case"xsd:nonPositiveInteger":case"xsd:negativeInteger":case"xsd:nonNegativeInteger":case"xsd:positiveInteger":case"xsd:short":case"xsd:byte":case"xsd:long":case"xsd:unsignedLong":case"xsd:unsignedInt":case"xsd:unsignedShort":case"xsd:unsignedByte":I.func=this._intConverter;I.jsType="number";break;case"xsd:string":I.func=this._textConverter;I.jsType="string";break;case"Restrictions":I.func=this._restrictionsConverter;I.jsType="object";break;default:I.func=this._textConverter;I.jsType="object";break}return I},_createFieldGetter:function(N,J,M,K){if(M===null){M="1"}if(K===null){K="1"}var L=this;var I;if(K==="1"){if(M==="1"){I=function(){var O=n(this.row,b,null,N);return J(L._elementText(O.item(0)))}}else{if(M==="0"){I=function(){var O=n(this.row,b,null,N);if(!O.length){return null}else{return J(L._elementText(O.item(0)))}}}}}else{if(M==="1"){I=function(){var O=n(this.row,b,null,N);return L._arrayConverter(O,J)}}else{if(M==="0"){I=function(){var O=n(this.row,b,null,N);if(!O.length){return null}else{return L._arrayConverter(O,J)}}}}}return I},getType:function(){return this._type},getFields:function(){var L=[],K=this._fieldCount,I=this.fieldOrder;for(var J=0;J<K;J++){L[J]=this.fieldDef(I[J])}return L},getFieldNames:function(){var K=[];for(var I=0,J=this.fieldCount();I<J;I++){K[I]=this.fieldOrder[I]}return K},hasMoreRows:function(){return this.numRows>this.rowIndex},next:function(){this.row=this.rows.item(++this.rowIndex)},curr:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this.row=(this.hasMoreRows())?this.rows.item(this.rowIndex):null},fieldDef:function(I){var J=this.fields[I];if(s(J)){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",I)._throw()}return J},fieldIndex:function(I){var J=this.fieldDef(I);return J.index},fieldName:function(I){var J=this.fieldOrder[I];if(s(J)){Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",I)._throw()}return J},fieldVal:function(I){if(A(I)){I=this.fieldName(I)}var J=this.fieldDef(I);return J.getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this.row=null;this.rows=null},readAsArray:function(){var L=[],I=this.fields,K,J;for(K in I){if(I.hasOwnProperty(K)){J=I[K];L[J.index]=J.getter.call(this)}}return L},fetchAsArray:function(){var I;if(this.hasMoreRows()){I=this.readAsArray();this.next()}else{I=false}return I},readAsObject:function(){var J={},I=this.fields,L,K;for(L in I){if(I.hasOwnProperty(L)){K=I[L];J[L]=K.getter.call(this)}}return J},fetchAsObject:function(){var I;if(this.hasMoreRows()){I=this.readAsObject();this.next()}else{I=false}return I},fetchCustom:function(J){var I;if(this.hasMoreRows()){I=J.call(this);this.next()}else{I=false}return I},fetchAllAsArray:function(I){var J;if(!I){I=[]}while((J=this.fetchAsArray())){I.push(J)}return I},fetchAllAsObject:function(I){var J;if(!I){I=[]}while((J=this.fetchAsObject())){I.push(J)}return I},fetchAllCustom:function(J,I){var K;if(!J){J=[]}while((K=this.fetchCustom(I))){J.push(K)}return J},mapAsObject:function(I,Q,S){var N,R,J,K,L=I;for(var O=0,M=Q.length,P=M-1;O<M;O++){N=Q[O];R=S[N];J=L[R];if(J){if(O===P){if(J instanceof Array){J.push(S)}else{L[R]=[J,S]}}else{L=J}}else{if(O===P){L[R]=S}else{L=L[R]={}}}}},mapAllAsObject:function(I,J){if(!J){J={}}if(!I){I=this.getKey()}var K;while(K=this.fetchAsObject()){this.mapAsObject(J,I,K)}return J},getKey:function(){var I;if(this._type){I=Xmla.Rowset.KEYS[this._type]}else{I=this.getFieldNames()}return I}};Xmla.Exception=function(J,L,K,I,N,M){this.type=J;this.code=L;this.message=K;this.source=N;this.helpfile=I;this.data=M;return this};Xmla.Exception.TYPE_WARNING="warning";Xmla.Exception.TYPE_ERROR="error";var e="http://code.google.com/p/xmla4js/wiki/ExceptionCodes";Xmla.Exception.MISSING_REQUEST_TYPE_CDE=-1;Xmla.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";Xmla.Exception.MISSING_REQUEST_TYPE_HLP=e+"#"+Xmla.Exception.MISSING_REQUEST_TYPE_CDE+"_"+Xmla.Exception.MISSING_REQUEST_TYPE_MSG;Xmla.Exception.MISSING_STATEMENT_CDE=-2;Xmla.Exception.MISSING_STATEMENT_MSG="Missing_Statement";Xmla.Exception.MISSING_STATEMENT_HLP=e+"#"+Xmla.Exception.MISSING_STATEMENT_CDE+"_"+Xmla.Exception.MISSING_STATEMENT_MSG;Xmla.Exception.MISSING_URL_CDE=-3;Xmla.Exception.MISSING_URL_MSG="Missing_URL";Xmla.Exception.MISSING_URL_HLP=e+"#"+Xmla.Exception.MISSING_URL_CDE+"_"+Xmla.Exception.MISSING_URL_MSG;Xmla.Exception.NO_EVENTS_SPECIFIED_CDE=-4;Xmla.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";Xmla.Exception.NO_EVENTS_SPECIFIED_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.WRONG_EVENTS_FORMAT_CDE=-5;Xmla.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";Xmla.Exception.WRONG_EVENTS_FORMAT_HLP=e+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.UNKNOWN_EVENT_CDE=-6;Xmla.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";Xmla.Exception.UNKNOWN_EVENT_HLP=e+"#"+Xmla.Exception.UNKNOWN_EVENT_CDE+"_"+Xmla.Exception.UNKNOWN_EVENT_MSG;Xmla.Exception.INVALID_EVENT_HANDLER_CDE=-7;Xmla.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";Xmla.Exception.INVALID_EVENT_HANDLER_HLP=e+"#"+Xmla.Exception.INVALID_EVENT_HANDLER_CDE+"_"+Xmla.Exception.INVALID_EVENT_HANDLER_MSG;Xmla.Exception.ERROR_PARSING_RESPONSE_CDE=-8;Xmla.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";Xmla.Exception.ERROR_PARSING_RESPONSE_HLP=e+"#"+Xmla.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+Xmla.Exception.ERROR_PARSING_RESPONSE_MSG;Xmla.Exception.INVALID_FIELD_CDE=-9;Xmla.Exception.INVALID_FIELD_MSG="Invalid_Field";Xmla.Exception.INVALID_FIELD_HLP=e+"#"+Xmla.Exception.INVALID_FIELD_CDE+"_"+Xmla.Exception.INVALID_FIELD_MSG;Xmla.Exception.HTTP_ERROR_CDE=-10;Xmla.Exception.HTTP_ERROR_MSG="HTTP Error";Xmla.Exception.HTTP_ERROR_HLP=e+"#"+Xmla.Exception.INVALID_FIELD_CDE+"_"+Xmla.Exception.INVALID_FIELD_MSG;Xmla.Exception._newError=function(I,K,J){return new Xmla.Exception(Xmla.Exception.TYPE_ERROR,Xmla.Exception[I+"_CDE"],Xmla.Exception[I+"_MSG"],Xmla.Exception[I+"_HLP"],K,J)};Xmla.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this}}}());