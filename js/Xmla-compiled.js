var Xmla;
(function(){var u="http://schemas.xmlsoap.org/soap/",v=u+"envelope/",o="SOAP-ENV",E="xmlns:"+o+'="'+v+'"',w=o+':encodingStyle="'+u+'encoding/"',x="urn:schemas-microsoft-com:",y=x+"xml-analysis",F='xmlns="'+y+'"',G="sql",H=x+"xml-sql",z="http://www.w3.org/2001/XMLSchema",A="xsd",I="http://www.w3.org/2001/XMLSchema-instance",J="xsi",r=y+":rowset",K=window.ActiveXObject?true:false;function L(a){var b,c=false;function d(){c=true;switch(b.readyState){case 0:a.aborted(b);break;case 4:b.status===200?a.complete(b):
a.error(Xmla.Exception._newError("HTTP_ERROR","_ajax",a));break}}b=K?new ActiveXObject("MSXML2.XMLHTTP.3.0"):new XMLHttpRequest;a.username&&a.password?b.open("POST",a.url,a.async,a.username,a.password):b.open("POST",a.url,a.async);b.onreadystatechange=d;b.setRequestHeader("Content-Type","text/xml");b.send(a.data);!a.async&&!c&&d.call(b);return b}function s(a){return typeof a==="undefined"}function B(a){return a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var m=document.getElementsByTagNameNS?
function(a,b,c,d){return a.getElementsByTagNameNS(b,d)}:function(a,b,c,d){return c?a.getElementsByTagName(c+":"+d):a.getElementsByTagName(d)},C=document.documentElement.getAttributeNS?function(a,b,c,d){return a.getAttributeNS(b,d)}:function(a,b,c,d){return c?a.getAttribute(c+":"+d):a.getAttribute(d)};function t(a,b,c,d){d||(d="");var f,e,h,i,l,n="\n"+d+"<"+a+">";if(c){n+="\n"+d+" <"+b+">";for(i in c)if(c.hasOwnProperty(i)){l=c[i];n+="\n"+d+"  <"+i+">";if(typeof l==="array"){e=0;for(f=l.length;e<f;e+=
1){h=l[e];n+="<Value>"+B(h)+"</Value>"}}else n+=B(l);n+="</"+i+">"}n+="\n"+d+" </"+b+">"}n+="\n"+d+"</"+a+">";return n}var D="RequestType";function M(a){var b="",c=a.method,d=null;b+="\n<"+o+":Envelope "+E+" "+w+">\n <"+o+":Body>\n  <"+c+" "+F+" "+w+">";switch(c){case Xmla.METHOD_DISCOVER:if(a.requestType)b+="\n   <"+D+">"+a.requestType+"</"+D+">"+t("Restrictions","RestrictionList",a.restrictions,"   ")+t("Properties","PropertyList",a.properties,"   ");else d=Xmla.Exception._newError("MISSING_REQUEST_TYPE",
"Xmla._getXmlaSoapMessage",a);break;case Xmla.METHOD_EXECUTE:if(a.statement)b+="\n   <Command>\n    <Statement>"+a.statement+"</Statement>\n   </Command>"+t("Properties","PropertyList",a.properties,"   ");else d=Xmla.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",a);break;default:}d!==null&&d._throw();b+="\n  </"+c+">\n </"+o+":Body>\n</"+o+":Envelope>";return b}function g(a,b,c){if(b&&!a)a={};for(var d in b)if(b.hasOwnProperty(d))if(c||s(a[d]))a[d]=b[d];return a}Xmla=function(a){this.listeners=
{};this.listeners[Xmla.EVENT_REQUEST]=[];this.listeners[Xmla.EVENT_SUCCESS]=[];this.listeners[Xmla.EVENT_ERROR]=[];this.listeners[Xmla.EVENT_DISCOVER]=[];this.listeners[Xmla.EVENT_DISCOVER_SUCCESS]=[];this.listeners[Xmla.EVENT_DISCOVER_ERROR]=[];this.listeners[Xmla.EVENT_EXECUTE]=[];this.listeners[Xmla.EVENT_EXECUTE_SUCCESS]=[];this.listeners[Xmla.EVENT_EXECUTE_ERROR]=[];this.options=g(g({},Xmla.defaultOptions,true),a,true);return this};Xmla.defaultOptions={requestTimeout:30000,async:false};Xmla.METHOD_DISCOVER=
"Discover";Xmla.METHOD_EXECUTE="Execute";var p="DISCOVER_",j="MDSCHEMA_",q="DBSCHEMA_";Xmla.DISCOVER_DATASOURCES=p+"DATASOURCES";Xmla.DISCOVER_PROPERTIES=p+"PROPERTIES";Xmla.DISCOVER_SCHEMA_ROWSETS=p+"SCHEMA_ROWSETS";Xmla.DISCOVER_ENUMERATORS=p+"ENUMERATORS";Xmla.DISCOVER_KEYWORDS=p+"KEYWORDS";Xmla.DISCOVER_LITERALS=p+"LITERALS";Xmla.DBSCHEMA_CATALOGS=q+"CATALOGS";Xmla.DBSCHEMA_COLUMNS=q+"COLUMNS";Xmla.DBSCHEMA_PROVIDER_TYPES=q+"PROVIDER_TYPES";Xmla.DBSCHEMA_SCHEMATA=q+"SCHEMATA";Xmla.DBSCHEMA_TABLES=
q+"TABLES";Xmla.DBSCHEMA_TABLES_INFO=q+"TABLES_INFO";Xmla.MDSCHEMA_ACTIONS=j+"ACTIONS";Xmla.MDSCHEMA_CUBES=j+"CUBES";Xmla.MDSCHEMA_DIMENSIONS=j+"DIMENSIONS";Xmla.MDSCHEMA_FUNCTIONS=j+"FUNCTIONS";Xmla.MDSCHEMA_HIERARCHIES=j+"HIERARCHIES";Xmla.MDSCHEMA_LEVELS=j+"LEVELS";Xmla.MDSCHEMA_MEASURES=j+"MEASURES";Xmla.MDSCHEMA_MEMBERS=j+"MEMBERS";Xmla.MDSCHEMA_PROPERTIES=j+"PROPERTIES";Xmla.MDSCHEMA_SETS=j+"SETS";Xmla.EVENT_REQUEST="request";Xmla.EVENT_SUCCESS="success";Xmla.EVENT_ERROR="error";Xmla.EVENT_EXECUTE=
"execute";Xmla.EVENT_EXECUTE_SUCCESS="executesuccess";Xmla.EVENT_EXECUTE_ERROR="executeerror";Xmla.EVENT_DISCOVER="discover";Xmla.EVENT_DISCOVER_SUCCESS="discoversuccess";Xmla.EVENT_DISCOVER_ERROR="discovererror";Xmla.EVENT_GENERAL=[Xmla.EVENT_REQUEST,Xmla.EVENT_SUCCESS,Xmla.EVENT_ERROR];Xmla.EVENT_DISCOVER_ALL=[Xmla.EVENT_DISCOVER,Xmla.EVENT_DISCOVER_SUCCESS,Xmla.EVENT_DISCOVER_ERROR];Xmla.EVENT_EXECUTE_ALL=[Xmla.EVENT_EXECUTE,Xmla.EVENT_EXECUTE_SUCCESS,Xmla.EVENT_EXECUTE_ERROR];Xmla.EVENT_ALL=[].concat(Xmla.EVENT_GENERAL,
Xmla.EVENT_DISCOVER_ALL,Xmla.EVENT_EXECUTE_ALL);Xmla.PROP_DATASOURCEINFO="DataSourceInfo";Xmla.PROP_CATALOG="Catalog";Xmla.PROP_CUBE="Cube";Xmla.PROP_FORMAT="Format";Xmla.PROP_FORMAT_TABULAR="Tabular";Xmla.PROP_FORMAT_MULTIDIMENSIONAL="Multidimensional";Xmla.PROP_AXISFORMAT="AxisFormat";Xmla.PROP_AXISFORMAT_TUPLE="TupleFormat";Xmla.PROP_AXISFORMAT_CLUSTER="ClusterFormat";Xmla.PROP_AXISFORMAT_CUSTOM="CustomFormat";Xmla.PROP_CONTENT="Content";Xmla.PROP_CONTENT_DATA="Data";Xmla.PROP_CONTENT_NONE="None";
Xmla.PROP_CONTENT_SCHEMA="Schema";Xmla.PROP_CONTENT_SCHEMADATA="SchemaData";Xmla.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXML:null,setOptions:function(a){g(this.options,a,true)},addListener:function(a){var b=a.events;b||Xmla.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",a)._throw();if(typeof b==="string")b=b==="all"?Xmla.EVENT_ALL:b.split(",");b instanceof Array||Xmla.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",a)._throw();
for(var c=b.length,d,f=0;f<c;f+=1){d=b[f].replace(/\s+/g,"");(d=this.listeners[d])||Xmla.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",a)._throw();if(typeof a.handler=="function"){if(!a.scope)a.scope=window;d.push(a)}else Xmla.Exception._newError("INVALID_EVENT_HANDLER","Xmla.addListener",a)._throw()}},_fireEvent:function(a,b,c){var d=this.listeners[a];d||Xmla.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",a)._throw();var f=d.length,e=true;if(f)for(var h,i=0;i<f;i+=1){h=d[i];h=h.handler.call(h.scope,
a,b,this);if(c&&h===false){e=false;break}}else a==="error"&&b.exception._throw();return e},request:function(a){var b,c=this;this.responseXML=this.responseText=this.response=null;if(!a.url)if(this.options.url)a.url=this.options.url;else{b=Xmla.Exception._newError("MISSING_URL","Xmla.request",a);b._throw()}a.properties=g(a.properties,this.options.properties,false);a.restrictions=g(a.restrictions,this.options.restrictions,false);if(s(a.async)&&!s(this.options.async))a.async=this.options.async;if(s(a.requestTimeout)&&
!s(this.options.requestTimeout))a.requestTimeout=this.options.requestTimeout;if(!a.username&&this.options.username)a.username=this.options.username;if(!a.password&&this.options.password)a.password=this.options.password;this.soapMessage=b=M(a);b={async:a.async,timeout:a.requestTimeout,data:b,error:function(d){a.exception=d;c._requestError(a)},complete:function(d){a.xhr=d;c._requestSuccess(a)},url:a.url};if(a.username)b.username=a.username;if(a.password)b.password=a.password;if(this._fireEvent(Xmla.EVENT_REQUEST,
a,true)&&(a.method==Xmla.METHOD_DISCOVER&&this._fireEvent(Xmla.EVENT_DISCOVER,a)||a.method==Xmla.METHOD_EXECUTE&&this._fireEvent(Xmla.EVENT_EXECUTE,a)))b=L(b);return this.response},_requestError:function(a){this._fireEvent("error",a)},_requestSuccess:function(a){var b=a.xhr;this.responseXML=b.responseXML;this.responseText=b.responseText;b=a.method;var c=m(this.responseXML,v,o,"Fault");if(c.length){c=c.item(0);a.exception=new Xmla.Exception(Xmla.Exception.TYPE_ERROR,c.getElementsByTagName("faultcode").item(0).childNodes.item(0).data,
c.getElementsByTagName("faultstring").item(0).childNodes.item(0).data,null,"_requestSuccess",a);switch(b){case Xmla.METHOD_DISCOVER:this._fireEvent(Xmla.EVENT_DISCOVER_ERROR,a);break;case Xmla.METHOD_EXECUTE:this._fireEvent(Xmla.EVENT_EXECUTE_ERROR,a);break}this._fireEvent(Xmla.EVENT_ERROR,a)}else{switch(b){case Xmla.METHOD_DISCOVER:var d=new Xmla.Rowset(this.responseXML,a.requestType);this.response=a.rowset=d;this._fireEvent(Xmla.EVENT_DISCOVER_SUCCESS,a);break;case Xmla.METHOD_EXECUTE:b=a.properties[Xmla.PROP_FORMAT];
switch(b){case Xmla.PROP_FORMAT_TABULAR:d=new Xmla.Rowset(this.responseXML);break;case Xmla.PROP_FORMAT_MULTIDIMENSIONAL:break}this.response=a.resultset=d;this._fireEvent(Xmla.EVENT_EXECUTE_SUCCESS,a);break}this._fireEvent(Xmla.EVENT_SUCCESS,a)}},execute:function(a){var b=a.properties;if(!b){b={};a.properties=b}g(b,this.options.properties,false);if(!b[Xmla.PROP_CONTENT])b[Xmla.PROP_CONTENT]=Xmla.PROP_CONTENT_SCHEMADATA;if(!b[Xmla.PROP_FORMAT])a.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL;
a=g(a,{method:Xmla.METHOD_EXECUTE},true);return this.request(a)},executeTabular:function(a){if(!a.properties)a.properties={};a.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_TABULAR;return this.execute(a)},executeMultiDimensional:function(a){if(!a.properties)a.properties={};a.properties[Xmla.PROP_FORMAT]=Xmla.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(a)},discover:function(a){a=g(a,{method:Xmla.METHOD_DISCOVER},true);if(!a.requestType)a.requestType=this.options.requestType;return this.request(a)},
discoverDataSources:function(a){a=g(a,{requestType:Xmla.DISCOVER_DATASOURCES},true);return this.discover(a)},discoverProperties:function(a){a=g(a,{requestType:Xmla.DISCOVER_PROPERTIES},true);return this.discover(a)},discoverSchemaRowsets:function(a){a=g(a,{requestType:Xmla.DISCOVER_SCHEMA_ROWSETS},true);return this.discover(a)},discoverEnumerators:function(a){a=g(a,{requestType:Xmla.DISCOVER_ENUMERATORS},true);return this.discover(a)},discoverKeywords:function(a){a=g(a,{requestType:Xmla.DISCOVER_KEYWORDS},
true);return this.discover(a)},discoverLiterals:function(a){a=g(a,{requestType:Xmla.DISCOVER_LITERALS},true);return this.discover(a)},discoverDBCatalogs:function(a){a=g(a,{requestType:Xmla.DBSCHEMA_CATALOGS},true);return this.discover(a)},discoverDBColumns:function(a){a=g(a,{requestType:Xmla.DBSCHEMA_COLUMNS},true);return this.discover(a)},discoverDBProviderTypes:function(a){a=g(a,{requestType:Xmla.DBSCHEMA_PROVIDER_TYPES},true);return this.discover(a)},discoverDBSchemata:function(a){a=g(a,{requestType:Xmla.DBSCHEMA_SCHEMATA},
true);return this.discover(a)},discoverDBTables:function(a){a=g(a,{requestType:Xmla.DBSCHEMA_TABLES},true);return this.discover(a)},discoverDBTablesInfo:function(a){a=g(a,{requestType:Xmla.DBSCHEMA_TABLES_INFO},true);return this.discover(a)},discoverMDActions:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_ACTIONS},true);return this.discover(a)},discoverMDCubes:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_CUBES},true);return this.discover(a)},discoverMDDimensions:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_DIMENSIONS},
true);return this.discover(a)},discoverMDFunctions:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_FUNCTIONS},true);return this.discover(a)},discoverMDHierarchies:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_HIERARCHIES},true);return this.discover(a)},discoverMDLevels:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_LEVELS},true);return this.discover(a)},discoverMDMeasures:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_MEASURES},true);return this.discover(a)},discoverMDMembers:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_MEMBERS},
true);return this.discover(a)},discoverMDProperties:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_PROPERTIES},true);return this.discover(a)},discoverMDSets:function(a){a=g(a,{requestType:Xmla.MDSCHEMA_SETS},true);return this.discover(a)}};function N(a){a=m(a,z,A,"complexType");var b=a.length,c,d;for(d=0;d<b;d+=1){c=a.item(d);if(c.getAttribute("name")==="row")return c}return null}Xmla.Rowset=function(a,b){this._node=a;this._type=b;this._initData();return this};Xmla.Rowset.MD_DIMTYPE_UNKNOWN=0;Xmla.Rowset.MD_DIMTYPE_TIME=
1;Xmla.Rowset.MD_DIMTYPE_MEASURE=2;Xmla.Rowset.MD_DIMTYPE_OTHER=3;Xmla.Rowset.MD_DIMTYPE_QUANTITATIVE=5;Xmla.Rowset.MD_DIMTYPE_ACCOUNTS=6;Xmla.Rowset.MD_DIMTYPE_CUSTOMERS=7;Xmla.Rowset.MD_DIMTYPE_PRODUCTS=8;Xmla.Rowset.MD_DIMTYPE_SCENARIO=9;Xmla.Rowset.MD_DIMTYPE_UTILIY=10;Xmla.Rowset.MD_DIMTYPE_CURRENCY=11;Xmla.Rowset.MD_DIMTYPE_RATES=12;Xmla.Rowset.MD_DIMTYPE_CHANNEL=13;Xmla.Rowset.MD_DIMTYPE_PROMOTION=14;Xmla.Rowset.MD_DIMTYPE_ORGANIZATION=15;Xmla.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;Xmla.Rowset.MD_DIMTYPE_GEOGRAPHY=
17;Xmla.Rowset.MD_STRUCTURE_FULLYBALANCED=0;Xmla.Rowset.MD_STRUCTURE_RAGGEDBALANCED=1;Xmla.Rowset.MD_STRUCTURE_UNBALANCED=2;Xmla.Rowset.MD_STRUCTURE_NETWORK=3;Xmla.Rowset.MD_USER_DEFINED=1;Xmla.Rowset.MD_SYSTEM_ENABLED=2;Xmla.Rowset.MD_SYSTEM_INTERNAL=4;Xmla.Rowset.KEYS={};Xmla.Rowset.KEYS[Xmla.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_COLUMNS]=["TABLE_CATALOG","TABLE_NAME","COLUMN_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_PROVIDER_TYPES]=["TYPE_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_SCHEMATA]=
["CATALOG_NAME","SCHEMA_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES]=["TABLE_CATALOG","TABLE_NAME"];Xmla.Rowset.KEYS[Xmla.DBSCHEMA_TABLES_INFO]=["TABLE_CATALOG","TABLE_NAME"];Xmla.Rowset.KEYS[Xmla.DISCOVER_DATASOURCES]=["DataSourceName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_KEYWORDS]=["Keyword"];Xmla.Rowset.KEYS[Xmla.DISCOVER_LITERALS]=["LiteralName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_PROPERTIES]=["PropertyName"];Xmla.Rowset.KEYS[Xmla.DISCOVER_SCHEMA_ROWSETS]=
["SchemaName"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_ACTIONS]=["CATALOG_NAME","CUBE_NAME","ACTION_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_CUBES]=["CATALOG_NAME","CUBE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_FUNCTIONS]=["FUNCTION_NAME","PARAMETER_LIST"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_LEVELS]=["CATALOG_NAME",
"CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEASURES]=["CATALOG_NAME","CUBE_NAME","MEASURE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_MEMBERS]=["CATALOG_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME","LEVEL_UNIQUE_NAME","MEMBER_UNIQUE_NAME"];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_PROPERTIES]=[];Xmla.Rowset.KEYS[Xmla.MDSCHEMA_SETS]=[];Xmla.Rowset.prototype={_node:null,_type:null,_row:null,_rows:null,numRows:null,fieldOrder:null,
fields:null,_fieldCount:null,_initData:function(){this.numRows=(this._rows=m(this._node,r,null,"row"))?this._rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var a=N(this._node);if(a){a=m(a,z,A,"sequence").item(0);a=a.childNodes;for(var b=a.length,c,d,f,e,h,i,l=0;l<b;l+=1){c=a.item(l);if(c.nodeType===1){d=C(c,H,G,"field");f=c.getAttribute("name");h=c.getAttribute("type");if(h===null&&this._row){e=this._row.getElementsByTagName(f);if(e.length)h=C(e.item(0),I,J,"type")}if(!h&&
this._type==Xmla.DISCOVER_SCHEMA_ROWSETS&&f==="Restrictions")h="Restrictions";e=(e=c.getAttribute("minOccurs"))?parseInt(e,10):1;if(c=c.getAttribute("maxOccurs"))if(c==="unbounded")c=Infinity;else e=parseInt(c,10);else c=1;i=this._getValueConverter(h);this.fields[d]={name:f,label:d,index:this._fieldCount++,type:h,jsType:i.jsType,minOccurs:e,maxOccurs:c,getter:this._createFieldGetter(f,i.func,e,c)};this.fieldOrder.push(d)}}}else Xmla.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",this._node)._throw()},
_boolConverter:function(a){return a==="true"?true:false},_intConverter:function(a){return parseInt(a,10)},_floatConverter:function(a){return parseFloat(a,10)},_textConverter:function(a){return a},_dateTimeConverter:function(a){return Date.parse(a)},_restrictionsConverter:function(a){return a},_arrayConverter:function(a,b){for(var c=[],d=a.length,f,e=0;e<d;e+=1){f=a.item(e);c.push(b(this._elementText(f)))}return c},_elementText:function(a){if(a.innerText)return a.innerText;else if(a.textContent)return a.textContent;
else if(a.normalize){a.normalize();return a.firstChild?a.firstChild.data:null}else{var b="";a=a.childNodes;for(var c=a.length,d=0;d<c;d+=1)b+=a.item(d).data;return b}},_getValueConverter:function(a){var b={};switch(a){case "xsd:boolean":b.func=this._boolConverter;b.jsType="boolean";break;case "xsd:decimal":case "xsd:double":case "xsd:float":b.func=this._floatConverter;b.jsType="number";break;case "xsd:int":case "xsd:integer":case "xsd:nonPositiveInteger":case "xsd:negativeInteger":case "xsd:nonNegativeInteger":case "xsd:positiveInteger":case "xsd:short":case "xsd:byte":case "xsd:long":case "xsd:unsignedLong":case "xsd:unsignedInt":case "xsd:unsignedShort":case "xsd:unsignedByte":b.func=
this._intConverter;b.jsType="number";break;case "xsd:string":b.func=this._textConverter;b.jsType="string";break;case "xsd:dateTime":b.func=this._dateTimeConverter;b.jsType="object";break;case "Restrictions":b.func=this._restrictionsConverter;b.jsType="object";break;default:b.func=this._textConverter;b.jsType="object";break}return b},_createFieldGetter:function(a,b,c,d){var f=this,e;if(d===1)if(c===1)e=function(){var h=m(this._row,r,null,a);return b(f._elementText(h.item(0)))};else{if(c===0)e=function(){var h=
m(this._row,r,null,a);return h.length?b(f._elementText(h.item(0))):null}}else if(c===1)e=function(){var h=m(this._row,r,null,a);return f._arrayConverter(h,b)};else if(c===0)e=function(){var h=m(this._row,r,null,a);return h.length?f._arrayConverter(h,b):null};return e},getType:function(){return this._type},getFields:function(){for(var a=[],b=this._fieldCount,c=this.fieldOrder,d=0;d<b;d+=1)a[d]=this.fieldDef(c[d]);return a},getFieldNames:function(){for(var a=[],b=0,c=this.fieldCount();b<c;b+=1)a[b]=
this.fieldOrder[b];return a},hasMoreRows:function(){return this.numRows>this.rowIndex},next:function(){this.rowIndex+=1;this._row=this._rows.item(this.rowIndex)},curr:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this._row=this.hasMoreRows()?this._rows.item(this.rowIndex):null},fieldDef:function(a){var b=this.fields[a];b||Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",a)._throw();return b},fieldIndex:function(a){a=this.fieldDef(a);
return a.index},fieldName:function(a){var b=this.fieldOrder[a];b||Xmla.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",a)._throw();return b},fieldVal:function(a){if(typeof a==="number")a=this.fieldName(a);a=this.fieldDef(a);return a.getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this._rows=this._row=this._node=null},readAsArray:function(){var a=[],b=this.fields,c,d;for(c in b)if(b.hasOwnProperty(c)){d=b[c];a[d.index]=d.getter.call(this)}return a},fetchAsArray:function(){var a;
if(this.hasMoreRows()){a=this.readAsArray();this.next()}else a=false;return a},readAsObject:function(){var a={},b=this.fields,c,d;for(c in b)if(b.hasOwnProperty(c)){d=b[c];a[c]=d.getter.call(this)}return a},fetchAsObject:function(){var a;if(this.hasMoreRows()){a=this.readAsObject();this.next()}else a=false;return a},fetchCustom:function(a){if(this.hasMoreRows()){a=a.call(this);this.next()}else a=false;return a},fetchAllAsArray:function(a){var b;for(a||(a=[]);b=this.fetchAsArray();)a.push(b);return a},
fetchAllAsObject:function(a){var b;for(a||(a=[]);b=this.fetchAsObject();)a.push(b);return a},fetchAllCustom:function(a,b){var c;for(a||(a=[]);c=this.fetchCustom(b);)a.push(c);return a},mapAsObject:function(a,b,c){var d,f,e=b.length,h=e-1,i=a;for(a=0;a<e;a+=1){d=b[a];d=c[d];if(f=i[d])if(a===h)if(f instanceof Array)f.push(c);else i[d]=[f,c];else i=f;else if(a===h)i[d]=c;else i=i[d]={}}},mapAllAsObject:function(a,b){b||(b={});a||(a=this.getKey());for(var c;c=this.fetchAsObject();)this.mapAsObject(b,
a,c);return b},getKey:function(){var a;return a=this._type?Xmla.Rowset.KEYS[this._type]:this.getFieldNames()}};Xmla.Exception=function(a,b,c,d,f,e){this.type=a;this.code=b;this.message=c;this.source=f;this.helpfile=d;this.data=e;return this};Xmla.Exception.TYPE_WARNING="warning";Xmla.Exception.TYPE_ERROR="error";var k="http://code.google.com/p/xmla4js/wiki/ExceptionCodes";Xmla.Exception.MISSING_REQUEST_TYPE_CDE=-1;Xmla.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";Xmla.Exception.MISSING_REQUEST_TYPE_HLP=
k+"#"+Xmla.Exception.MISSING_REQUEST_TYPE_CDE+"_"+Xmla.Exception.MISSING_REQUEST_TYPE_MSG;Xmla.Exception.MISSING_STATEMENT_CDE=-2;Xmla.Exception.MISSING_STATEMENT_MSG="Missing_Statement";Xmla.Exception.MISSING_STATEMENT_HLP=k+"#"+Xmla.Exception.MISSING_STATEMENT_CDE+"_"+Xmla.Exception.MISSING_STATEMENT_MSG;Xmla.Exception.MISSING_URL_CDE=-3;Xmla.Exception.MISSING_URL_MSG="Missing_URL";Xmla.Exception.MISSING_URL_HLP=k+"#"+Xmla.Exception.MISSING_URL_CDE+"_"+Xmla.Exception.MISSING_URL_MSG;Xmla.Exception.NO_EVENTS_SPECIFIED_CDE=
-4;Xmla.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";Xmla.Exception.NO_EVENTS_SPECIFIED_HLP=k+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.WRONG_EVENTS_FORMAT_CDE=-5;Xmla.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";Xmla.Exception.WRONG_EVENTS_FORMAT_HLP=k+"#"+Xmla.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+Xmla.Exception.NO_EVENTS_SPECIFIED_MSG;Xmla.Exception.UNKNOWN_EVENT_CDE=-6;Xmla.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";
Xmla.Exception.UNKNOWN_EVENT_HLP=k+"#"+Xmla.Exception.UNKNOWN_EVENT_CDE+"_"+Xmla.Exception.UNKNOWN_EVENT_MSG;Xmla.Exception.INVALID_EVENT_HANDLER_CDE=-7;Xmla.Exception.INVALID_EVENT_HANDLER_MSG="Invalid_Events_Handler";Xmla.Exception.INVALID_EVENT_HANDLER_HLP=k+"#"+Xmla.Exception.INVALID_EVENT_HANDLER_CDE+"_"+Xmla.Exception.INVALID_EVENT_HANDLER_MSG;Xmla.Exception.ERROR_PARSING_RESPONSE_CDE=-8;Xmla.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";Xmla.Exception.ERROR_PARSING_RESPONSE_HLP=
k+"#"+Xmla.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+Xmla.Exception.ERROR_PARSING_RESPONSE_MSG;Xmla.Exception.INVALID_FIELD_CDE=-9;Xmla.Exception.INVALID_FIELD_MSG="Invalid_Field";Xmla.Exception.INVALID_FIELD_HLP=k+"#"+Xmla.Exception.INVALID_FIELD_CDE+"_"+Xmla.Exception.INVALID_FIELD_MSG;Xmla.Exception.HTTP_ERROR_CDE=-10;Xmla.Exception.HTTP_ERROR_MSG="HTTP Error";Xmla.Exception.HTTP_ERROR_HLP=k+"#"+Xmla.Exception.HTTP_ERROR_CDE+"_"+Xmla.Exception.HTTP_ERROR_MSG;Xmla.Exception._newError=function(a,
b,c){return new Xmla.Exception(Xmla.Exception.TYPE_ERROR,Xmla.Exception[a+"_CDE"],Xmla.Exception[a+"_MSG"],Xmla.Exception[a+"_HLP"],b,c)};Xmla.Exception.prototype={type:null,code:null,message:null,source:null,helpfile:null,data:null,_throw:function(){throw this;}}})();
